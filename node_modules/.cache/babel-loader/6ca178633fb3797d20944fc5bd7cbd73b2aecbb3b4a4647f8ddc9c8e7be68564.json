{"ast":null,"code":"import _objectSpread from\"/Users/pmelegatti/Development/Financial Resume/financial-resume-engine-frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{createPortal}from'react-dom';import{Plus,Search,TrendingDown,Calendar,Edit,Trash2,CheckCircle,XCircle}from'lucide-react';import{expensesAPI,categoriesAPI,formatCurrency,formatPercentage}from'../services/api';import{mockExpenses,mockCategories,simulateNetworkDelay,createMockResponse}from'../services/mockData';import{usePeriod}from'../contexts/PeriodContext';import toast from'react-hot-toast';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const Expenses=()=>{const[expenses,setExpenses]=useState([]);const[categories,setCategories]=useState([]);const[loading,setLoading]=useState(true);const[showModal,setShowModal]=useState(false);const[showPaymentModal,setShowPaymentModal]=useState(false);const[editingExpense,setEditingExpense]=useState(null);const[payingExpense,setPayingExpense]=useState(null);const[searchTerm,setSearchTerm]=useState('');const[filterPaid,setFilterPaid]=useState('all');const[paymentAmount,setPaymentAmount]=useState('');const[formData,setFormData]=useState({description:'',amount:'',category_id:'',due_date:'',paid:false});// Usar el contexto global de per√≠odo\nconst{selectedYear,selectedMonth,balancesHidden}=usePeriod();const formatAmount=amount=>{if(balancesHidden)return'‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢';return formatCurrency(amount);};const loadData=React.useCallback(async()=>{try{var _expensesResponse$dat,_categoriesResponse$d;setLoading(true);const[expensesResponse,categoriesResponse]=await Promise.all([expensesAPI.list(),categoriesAPI.list()]);// Asegurar que siempre sean arrays\nconst expensesData=((_expensesResponse$dat=expensesResponse.data)===null||_expensesResponse$dat===void 0?void 0:_expensesResponse$dat.expenses)||expensesResponse.data||[];const categoriesData=((_categoriesResponse$d=categoriesResponse.data)===null||_categoriesResponse$d===void 0?void 0:_categoriesResponse$d.data)||categoriesResponse.data||[];setExpenses(Array.isArray(expensesData)?expensesData:[]);setCategories(Array.isArray(categoriesData)?categoriesData:[]);}catch(error){console.warn('‚ö†Ô∏è API no disponible, usando datos mock:',error.message);// Fallback a datos mock\nawait simulateNetworkDelay(300);setExpenses(mockExpenses);setCategories(mockCategories);toast.success('üöß Usando datos de ejemplo (backend no disponible)',{duration:2000});}finally{setLoading(false);}},[]);useEffect(()=>{loadData();},[loadData]);const handleSubmit=async e=>{e.preventDefault();try{// Convertir amount a n√∫mero antes de enviar\nconst dataToSend=_objectSpread(_objectSpread({},formData),{},{amount:parseFloat(formData.amount)});if(editingExpense){await expensesAPI.update(editingExpense.user_id,editingExpense.id,dataToSend);toast.success('Gasto actualizado correctamente');}else{await expensesAPI.create(dataToSend);toast.success('Gasto creado correctamente');}setShowModal(false);setEditingExpense(null);setFormData({description:'',amount:'',category_id:'',due_date:'',paid:false});loadData();}catch(error){toast.error('Error al guardar el gasto');}};const handleEdit=expense=>{setEditingExpense(expense);setFormData({description:expense.description,amount:expense.amount.toString(),category_id:expense.category_id||'',due_date:expense.due_date||'',paid:expense.paid});setShowModal(true);};const handleDelete=async expense=>{if(window.confirm('¬øEst√°s seguro de que quieres eliminar este gasto?')){try{await expensesAPI.delete(expense.user_id,expense.id);toast.success('Gasto eliminado correctamente');loadData();}catch(error){toast.error('Error al eliminar el gasto');}}};const togglePaid=async expense=>{if(expense.paid){// Si ya est√° pagado, permitir marcarlo como no pagado\ntry{const updateData={paid:false};await expensesAPI.update(expense.user_id,expense.id,updateData);toast.success('Gasto marcado como pendiente');loadData();}catch(error){toast.error('Error al actualizar el estado del gasto');}}else{// Si no est√° pagado, abrir modal de pago\nsetPayingExpense(expense);const pendingAmount=expense.pending_amount||expense.amount-(expense.amount_paid||0);setPaymentAmount(pendingAmount.toString());setShowPaymentModal(true);}};const handlePayment=async paymentType=>{try{if(paymentType==='total'){// Pago total - marcar como pagado\nconst updateData={paid:true};await expensesAPI.update(payingExpense.user_id,payingExpense.id,updateData);toast.success('Gasto pagado completamente');}else if(paymentType==='partial'){// Pago parcial - enviar payment_amount\nconst paymentAmt=parseFloat(paymentAmount);if(paymentAmt<=0||paymentAmt>payingExpense.amount){toast.error('Monto de pago inv√°lido');return;}const updateData={payment_amount:paymentAmt};await expensesAPI.update(payingExpense.user_id,payingExpense.id,updateData);// Verificar si el pago cubre el total\nconst remaining=payingExpense.amount-(payingExpense.amount_paid||0)-paymentAmt;if(remaining<=0){toast.success('Gasto pagado completamente');}else{toast.success(\"Pago parcial registrado. Quedan \".concat(formatCurrency(remaining),\" pendientes\"));}}setShowPaymentModal(false);setPayingExpense(null);setPaymentAmount('');loadData();}catch(error){toast.error('Error al procesar el pago');}};const filteredExpenses=Array.isArray(expenses)?expenses.filter(expense=>{const matchesSearch=expense.description.toLowerCase().includes(searchTerm.toLowerCase());const matchesFilter=filterPaid==='all'||filterPaid==='paid'&&expense.paid||filterPaid==='unpaid'&&!expense.paid;// Filtros de fecha\nconst expenseDate=new Date(expense.created_at);const matchesYear=!selectedYear||expenseDate.getFullYear().toString()===selectedYear;const matchesMonth=!selectedMonth||expense.created_at.slice(0,7)===selectedMonth;return matchesSearch&&matchesFilter&&matchesYear&&matchesMonth;}):[];const totalExpenses=filteredExpenses.reduce((sum,expense)=>sum+expense.amount,0);const unpaidExpenses=filteredExpenses.filter(e=>!e.paid);if(loading){return/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-center h-64\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"spinner\"}),/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 text-fr-gray-600\",children:\"Cargando gastos...\"})]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-3 gap-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium text-fr-gray-600\",children:\"Total Gastos\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold text-fr-gray-900\",children:formatAmount(totalExpenses)})]}),/*#__PURE__*/_jsx(\"div\",{className:\"p-3 rounded-fr bg-gray-100\",children:/*#__PURE__*/_jsx(TrendingDown,{className:\"w-6 h-6 text-fr-gray-900\"})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"card\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium text-fr-gray-600\",children:\"Gastos Pendientes\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold text-fr-gray-900\",children:unpaidExpenses.length})]}),/*#__PURE__*/_jsx(\"div\",{className:\"p-3 rounded-fr bg-gray-100\",children:/*#__PURE__*/_jsx(Calendar,{className:\"w-6 h-6 text-fr-gray-900\"})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"card\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium text-fr-gray-600\",children:\"Monto Pendiente\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold text-fr-gray-900\",children:formatAmount(unpaidExpenses.reduce((sum,e)=>sum+e.amount,0))})]}),/*#__PURE__*/_jsx(\"div\",{className:\"p-3 rounded-fr bg-gray-100\",children:/*#__PURE__*/_jsx(XCircle,{className:\"w-6 h-6 text-fr-gray-900\"})})]})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"card\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-col lg:flex-row space-y-4 lg:space-y-0 lg:space-x-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(Search,{className:\"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-fr-gray-400\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Buscar gastos...\",value:searchTerm,onChange:e=>setSearchTerm(e.target.value),className:\"pl-10 input w-full sm:w-64\"})]}),/*#__PURE__*/_jsxs(\"select\",{value:filterPaid,onChange:e=>setFilterPaid(e.target.value),className:\"input w-full sm:w-auto\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"all\",children:\"Todos los gastos\"}),/*#__PURE__*/_jsx(\"option\",{value:\"paid\",children:\"Pagados\"}),/*#__PURE__*/_jsx(\"option\",{value:\"unpaid\",children:\"Pendientes\"})]})]})}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowModal(true),className:\"btn-primary flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(Plus,{className:\"w-4 h-4\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Nuevo Gasto\"})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"card\",children:/*#__PURE__*/_jsx(\"div\",{className:\"space-y-4\",children:filteredExpenses.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-12\",children:[/*#__PURE__*/_jsx(TrendingDown,{className:\"w-12 h-12 text-fr-gray-400 mx-auto mb-4\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-fr-gray-900 mb-2\",children:\"No hay gastos\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-fr-gray-500\",children:\"Comienza agregando tu primer gasto\"})]}):filteredExpenses.map(expense=>{const category=categories.find(c=>c.id===expense.category_id);return/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between p-4 rounded-fr bg-fr-gray-50 hover:bg-fr-gray-100 transition-colors\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-4\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>togglePaid(expense),className:\"p-2 rounded-fr transition-colors \".concat(expense.paid?'bg-green-100 text-fr-secondary hover:bg-green-200':'bg-red-100 text-fr-error hover:bg-red-200'),children:expense.paid?/*#__PURE__*/_jsx(CheckCircle,{className:\"w-5 h-5\"}):/*#__PURE__*/_jsx(XCircle,{className:\"w-5 h-5\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-medium text-fr-gray-900\",children:expense.description}),category&&/*#__PURE__*/_jsx(\"span\",{className:\"badge-info\",children:category.name}),expense.paid&&/*#__PURE__*/_jsx(\"span\",{className:\"badge-success\",children:\"Pagado\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-4 mt-1 text-sm text-fr-gray-500\",children:[expense.due_date&&/*#__PURE__*/_jsxs(\"span\",{children:[\"Vence: \",new Date(expense.due_date).toLocaleDateString('es-AR')]}),/*#__PURE__*/_jsxs(\"span\",{children:[\"Creado: \",new Date(expense.created_at).toLocaleDateString('es-AR')]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-right\",children:[expense.amount_paid>0&&expense.amount_paid<expense.amount?/*#__PURE__*/// Pago parcial - mostrar total vs pendiente\n_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-fr-gray-900 text-lg\",children:formatAmount(expense.pending_amount||expense.amount-(expense.amount_paid||0))}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-fr-gray-500\",children:[\"de \",formatAmount(expense.amount),\" total\"]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-fr-secondary\",children:[\"Pagado: \",formatAmount(expense.amount_paid||0)]})]}):/*#__PURE__*/// Sin pagos parciales - mostrar solo el monto\n_jsx(\"p\",{className:\"font-semibold text-fr-gray-900 text-lg\",children:formatAmount(expense.amount)}),expense.percentage&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-fr-gray-500\",children:[formatPercentage(expense.percentage),\" del total\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleEdit(expense),className:\"p-2 rounded-fr text-fr-gray-600 hover:bg-fr-gray-200 transition-colors\",children:/*#__PURE__*/_jsx(Edit,{className:\"w-4 h-4\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleDelete(expense),className:\"p-2 rounded-fr text-fr-error hover:bg-red-100 transition-colors\",children:/*#__PURE__*/_jsx(Trash2,{className:\"w-4 h-4\"})})]})]})]},expense.id);})})}),showModal&&/*#__PURE__*/createPortal(/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[9999] p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-fr-lg max-w-md w-full p-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-fr-gray-900 mb-6\",children:editingExpense?'Editar Gasto':'Nuevo Gasto'}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-fr-gray-700 mb-2\",children:\"Descripci\\xF3n\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.description,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{description:e.target.value})),className:\"input\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-fr-gray-700 mb-2\",children:\"Monto\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",step:\"0.01\",value:formData.amount,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{amount:e.target.value})),className:\"input\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-fr-gray-700 mb-2\",children:\"Categor\\xEDa\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.category_id,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{category_id:e.target.value})),className:\"input\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Seleccionar categor\\xEDa\"}),categories.map(category=>/*#__PURE__*/_jsx(\"option\",{value:category.id,children:category.name},category.id))]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-fr-gray-700 mb-2\",children:\"Fecha de vencimiento\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:formData.due_date,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{due_date:e.target.value})),className:\"input\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",id:\"paid\",checked:formData.paid,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{paid:e.target.checked})),className:\"mr-2\"}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"paid\",className:\"text-sm font-medium text-fr-gray-700\",children:\"Marcar como pagado\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-4 pt-4\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>{setShowModal(false);setEditingExpense(null);setFormData({description:'',amount:'',category_id:'',due_date:'',paid:false});},className:\"btn-outline flex-1\",children:\"Cancelar\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn-primary flex-1\",children:editingExpense?'Actualizar':'Crear'})]})]})]})}),document.body),showPaymentModal&&payingExpense&&/*#__PURE__*/createPortal(/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[9999] p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-fr-lg max-w-md w-full p-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-fr-gray-900 mb-6\",children:\"Registrar Pago\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-fr-gray-50 rounded-fr p-4 mb-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-medium text-fr-gray-900 mb-2\",children:payingExpense.description}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-1\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-lg font-bold text-fr-gray-900\",children:[\"Monto total: \",formatCurrency(payingExpense.amount)]}),payingExpense.amount_paid>0&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-fr-secondary\",children:[\"Ya pagado: \",formatCurrency(payingExpense.amount_paid)]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-lg font-bold text-fr-accent\",children:[\"Pendiente: \",formatCurrency(payingExpense.pending_amount||payingExpense.amount-payingExpense.amount_paid)]})]})]}),payingExpense.due_date&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-fr-gray-600 mt-1\",children:[\"Vence: \",new Date(payingExpense.due_date).toLocaleDateString('es-AR')]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>handlePayment('total'),className:\"w-full p-4 border-2 border-fr-secondary rounded-fr hover:bg-green-50 transition-colors text-left\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-medium text-fr-gray-900\",children:\"\\uD83D\\uDCB0 Pago Total\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-fr-gray-600\",children:\"Marcar como completamente pagado\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"font-bold text-fr-secondary\",children:formatCurrency(payingExpense.pending_amount||payingExpense.amount-(payingExpense.amount_paid||0))})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"border-2 border-fr-accent rounded-fr p-4\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-medium text-fr-gray-900 mb-3\",children:\"\\uD83D\\uDCB8 Pago Parcial\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-fr-gray-700 mb-2\",children:\"Monto a pagar\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",step:\"0.01\",max:payingExpense.pending_amount||payingExpense.amount-(payingExpense.amount_paid||0),value:paymentAmount,onChange:e=>setPaymentAmount(e.target.value),className:\"input\",placeholder:\"0.00\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-fr-gray-600\",children:/*#__PURE__*/_jsxs(\"p\",{children:[\"Quedar\\xEDan pendientes: \",/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:formatCurrency(Math.max(0,(payingExpense.pending_amount||payingExpense.amount-(payingExpense.amount_paid||0))-(parseFloat(paymentAmount)||0)))})]})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handlePayment('partial'),disabled:!paymentAmount||parseFloat(paymentAmount)<=0,className:\"w-full btn-primary disabled:opacity-50 disabled:cursor-not-allowed\",children:\"Registrar Pago Parcial\"})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex space-x-4 pt-6\",children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>{setShowPaymentModal(false);setPayingExpense(null);setPaymentAmount('');},className:\"btn-outline flex-1\",children:\"Cancelar\"})})]})}),document.body)]});};export default Expenses;","map":{"version":3,"names":["React","useState","useEffect","createPortal","Plus","Search","TrendingDown","Calendar","Edit","Trash2","CheckCircle","XCircle","expensesAPI","categoriesAPI","formatCurrency","formatPercentage","mockExpenses","mockCategories","simulateNetworkDelay","createMockResponse","usePeriod","toast","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Expenses","expenses","setExpenses","categories","setCategories","loading","setLoading","showModal","setShowModal","showPaymentModal","setShowPaymentModal","editingExpense","setEditingExpense","payingExpense","setPayingExpense","searchTerm","setSearchTerm","filterPaid","setFilterPaid","paymentAmount","setPaymentAmount","formData","setFormData","description","amount","category_id","due_date","paid","selectedYear","selectedMonth","balancesHidden","formatAmount","loadData","useCallback","_expensesResponse$dat","_categoriesResponse$d","expensesResponse","categoriesResponse","Promise","all","list","expensesData","data","categoriesData","Array","isArray","error","console","warn","message","success","duration","handleSubmit","e","preventDefault","dataToSend","_objectSpread","parseFloat","update","user_id","id","create","handleEdit","expense","toString","handleDelete","window","confirm","delete","togglePaid","updateData","pendingAmount","pending_amount","amount_paid","handlePayment","paymentType","paymentAmt","payment_amount","remaining","concat","filteredExpenses","filter","matchesSearch","toLowerCase","includes","matchesFilter","expenseDate","Date","created_at","matchesYear","getFullYear","matchesMonth","slice","totalExpenses","reduce","sum","unpaidExpenses","className","children","length","type","placeholder","value","onChange","target","onClick","map","category","find","c","name","toLocaleDateString","percentage","onSubmit","required","step","checked","htmlFor","document","body","max","Math","disabled"],"sources":["/Users/pmelegatti/Development/Financial Resume/financial-resume-engine-frontend/src/pages/Expenses.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { createPortal } from 'react-dom';\nimport { \n  Plus, \n  Search, \n  TrendingDown, \n  Calendar,\n  Edit,\n  Trash2,\n  CheckCircle,\n  XCircle\n} from 'lucide-react';\nimport { expensesAPI, categoriesAPI, formatCurrency, formatPercentage } from '../services/api';\nimport { mockExpenses, mockCategories, simulateNetworkDelay, createMockResponse } from '../services/mockData';\nimport { usePeriod } from '../contexts/PeriodContext';\nimport toast from 'react-hot-toast';\n\nconst Expenses = () => {\n  const [expenses, setExpenses] = useState([]);\n  const [categories, setCategories] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [showModal, setShowModal] = useState(false);\n  const [showPaymentModal, setShowPaymentModal] = useState(false);\n  const [editingExpense, setEditingExpense] = useState(null);\n  const [payingExpense, setPayingExpense] = useState(null);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [filterPaid, setFilterPaid] = useState('all');\n  const [paymentAmount, setPaymentAmount] = useState('');\n  const [formData, setFormData] = useState({\n    description: '',\n    amount: '',\n    category_id: '',\n    due_date: '',\n    paid: false,\n  });\n\n  // Usar el contexto global de per√≠odo\n  const {\n    selectedYear,\n    selectedMonth,\n    balancesHidden,\n  } = usePeriod();\n\n  const formatAmount = (amount) => {\n    if (balancesHidden) return '‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢';\n    return formatCurrency(amount);\n  };\n\n  const loadData = React.useCallback(async () => {\n    try {\n      setLoading(true);\n      const [expensesResponse, categoriesResponse] = await Promise.all([\n        expensesAPI.list(),\n        categoriesAPI.list(),\n      ]);\n      \n      // Asegurar que siempre sean arrays\n      const expensesData = expensesResponse.data?.expenses || expensesResponse.data || [];\n      const categoriesData = categoriesResponse.data?.data || categoriesResponse.data || [];\n      \n      setExpenses(Array.isArray(expensesData) ? expensesData : []);\n      setCategories(Array.isArray(categoriesData) ? categoriesData : []);\n    } catch (error) {\n      console.warn('‚ö†Ô∏è API no disponible, usando datos mock:', error.message);\n      \n      // Fallback a datos mock\n      await simulateNetworkDelay(300);\n      setExpenses(mockExpenses);\n      setCategories(mockCategories);\n      \n      toast.success('üöß Usando datos de ejemplo (backend no disponible)', {\n        duration: 2000,\n      });\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  useEffect(() => {\n    loadData();\n  }, [loadData]);\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    try {\n      // Convertir amount a n√∫mero antes de enviar\n      const dataToSend = {\n        ...formData,\n        amount: parseFloat(formData.amount)\n      };\n\n      if (editingExpense) {\n        await expensesAPI.update(editingExpense.user_id, editingExpense.id, dataToSend);\n        toast.success('Gasto actualizado correctamente');\n      } else {\n        await expensesAPI.create(dataToSend);\n        toast.success('Gasto creado correctamente');\n      }\n      setShowModal(false);\n      setEditingExpense(null);\n      setFormData({\n        description: '',\n        amount: '',\n        category_id: '',\n        due_date: '',\n        paid: false,\n      });\n      loadData();\n    } catch (error) {\n      toast.error('Error al guardar el gasto');\n    }\n  };\n\n  const handleEdit = (expense) => {\n    setEditingExpense(expense);\n    setFormData({\n      description: expense.description,\n      amount: expense.amount.toString(),\n      category_id: expense.category_id || '',\n      due_date: expense.due_date || '',\n      paid: expense.paid,\n    });\n    setShowModal(true);\n  };\n\n  const handleDelete = async (expense) => {\n    if (window.confirm('¬øEst√°s seguro de que quieres eliminar este gasto?')) {\n      try {\n        await expensesAPI.delete(expense.user_id, expense.id);\n        toast.success('Gasto eliminado correctamente');\n        loadData();\n      } catch (error) {\n        toast.error('Error al eliminar el gasto');\n      }\n    }\n  };\n\n  const togglePaid = async (expense) => {\n    if (expense.paid) {\n      // Si ya est√° pagado, permitir marcarlo como no pagado\n      try {\n        const updateData = { paid: false };\n        await expensesAPI.update(expense.user_id, expense.id, updateData);\n        toast.success('Gasto marcado como pendiente');\n        loadData();\n      } catch (error) {\n        toast.error('Error al actualizar el estado del gasto');\n      }\n    } else {\n      // Si no est√° pagado, abrir modal de pago\n      setPayingExpense(expense);\n      const pendingAmount = expense.pending_amount || (expense.amount - (expense.amount_paid || 0));\n      setPaymentAmount(pendingAmount.toString());\n      setShowPaymentModal(true);\n    }\n  };\n\n  const handlePayment = async (paymentType) => {\n    try {\n      if (paymentType === 'total') {\n        // Pago total - marcar como pagado\n        const updateData = { paid: true };\n        await expensesAPI.update(payingExpense.user_id, payingExpense.id, updateData);\n        toast.success('Gasto pagado completamente');\n      } else if (paymentType === 'partial') {\n        // Pago parcial - enviar payment_amount\n        const paymentAmt = parseFloat(paymentAmount);\n        if (paymentAmt <= 0 || paymentAmt > payingExpense.amount) {\n          toast.error('Monto de pago inv√°lido');\n          return;\n        }\n        \n        const updateData = { payment_amount: paymentAmt };\n        await expensesAPI.update(payingExpense.user_id, payingExpense.id, updateData);\n        \n        // Verificar si el pago cubre el total\n        const remaining = payingExpense.amount - (payingExpense.amount_paid || 0) - paymentAmt;\n        if (remaining <= 0) {\n          toast.success('Gasto pagado completamente');\n        } else {\n          toast.success(`Pago parcial registrado. Quedan ${formatCurrency(remaining)} pendientes`);\n        }\n      }\n      \n      setShowPaymentModal(false);\n      setPayingExpense(null);\n      setPaymentAmount('');\n      loadData();\n    } catch (error) {\n      toast.error('Error al procesar el pago');\n    }\n  };\n\n  const filteredExpenses = Array.isArray(expenses) \n    ? expenses.filter(expense => {\n        const matchesSearch = expense.description.toLowerCase().includes(searchTerm.toLowerCase());\n        const matchesFilter = filterPaid === 'all' || \n          (filterPaid === 'paid' && expense.paid) ||\n          (filterPaid === 'unpaid' && !expense.paid);\n        \n        // Filtros de fecha\n        const expenseDate = new Date(expense.created_at);\n        const matchesYear = !selectedYear || expenseDate.getFullYear().toString() === selectedYear;\n        const matchesMonth = !selectedMonth || expense.created_at.slice(0, 7) === selectedMonth;\n        \n        return matchesSearch && matchesFilter && matchesYear && matchesMonth;\n      })\n    : [];\n\n  const totalExpenses = filteredExpenses.reduce((sum, expense) => sum + expense.amount, 0);\n  const unpaidExpenses = filteredExpenses.filter(e => !e.paid);\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center h-64\">\n        <div className=\"spinner\"></div>\n        <span className=\"ml-2 text-fr-gray-600\">Cargando gastos...</span>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header con m√©tricas */}\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n        <div className=\"card\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <p className=\"text-sm font-medium text-fr-gray-600\">Total Gastos</p>\n              <p className=\"text-2xl font-bold text-fr-gray-900\">{formatAmount(totalExpenses)}</p>\n            </div>\n            <div className=\"p-3 rounded-fr bg-gray-100\">\n              <TrendingDown className=\"w-6 h-6 text-fr-gray-900\" />\n            </div>\n          </div>\n        </div>\n\n        <div className=\"card\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <p className=\"text-sm font-medium text-fr-gray-600\">Gastos Pendientes</p>\n              <p className=\"text-2xl font-bold text-fr-gray-900\">{unpaidExpenses.length}</p>\n            </div>\n            <div className=\"p-3 rounded-fr bg-gray-100\">\n              <Calendar className=\"w-6 h-6 text-fr-gray-900\" />\n            </div>\n          </div>\n        </div>\n\n        <div className=\"card\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <p className=\"text-sm font-medium text-fr-gray-600\">Monto Pendiente</p>\n                              <p className=\"text-2xl font-bold text-fr-gray-900\">\n                  {formatAmount(unpaidExpenses.reduce((sum, e) => sum + e.amount, 0))}\n                </p>\n            </div>\n            <div className=\"p-3 rounded-fr bg-gray-100\">\n              <XCircle className=\"w-6 h-6 text-fr-gray-900\" />\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Controles */}\n      <div className=\"card\">\n        <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0\">\n          <div className=\"flex flex-col lg:flex-row space-y-4 lg:space-y-0 lg:space-x-4\">\n            {/* Primera fila: B√∫squeda y Estado */}\n            <div className=\"flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-4\">\n              {/* B√∫squeda */}\n              <div className=\"relative\">\n                <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-fr-gray-400\" />\n                <input\n                  type=\"text\"\n                  placeholder=\"Buscar gastos...\"\n                  value={searchTerm}\n                  onChange={(e) => setSearchTerm(e.target.value)}\n                  className=\"pl-10 input w-full sm:w-64\"\n                />\n              </div>\n\n              {/* Filtro */}\n              <select\n                value={filterPaid}\n                onChange={(e) => setFilterPaid(e.target.value)}\n                className=\"input w-full sm:w-auto\"\n              >\n                <option value=\"all\">Todos los gastos</option>\n                <option value=\"paid\">Pagados</option>\n                <option value=\"unpaid\">Pendientes</option>\n              </select>\n            </div>\n\n\n          </div>\n\n          <button\n            onClick={() => setShowModal(true)}\n            className=\"btn-primary flex items-center space-x-2\"\n          >\n            <Plus className=\"w-4 h-4\" />\n            <span>Nuevo Gasto</span>\n          </button>\n        </div>\n      </div>\n\n      {/* Lista de gastos */}\n      <div className=\"card\">\n        <div className=\"space-y-4\">\n          {filteredExpenses.length === 0 ? (\n            <div className=\"text-center py-12\">\n              <TrendingDown className=\"w-12 h-12 text-fr-gray-400 mx-auto mb-4\" />\n              <h3 className=\"text-lg font-medium text-fr-gray-900 mb-2\">No hay gastos</h3>\n              <p className=\"text-fr-gray-500\">Comienza agregando tu primer gasto</p>\n            </div>\n          ) : (\n            filteredExpenses.map((expense) => {\n              const category = categories.find(c => c.id === expense.category_id);\n              return (\n                <div key={expense.id} className=\"flex items-center justify-between p-4 rounded-fr bg-fr-gray-50 hover:bg-fr-gray-100 transition-colors\">\n                  <div className=\"flex items-center space-x-4\">\n                    <button\n                      onClick={() => togglePaid(expense)}\n                      className={`p-2 rounded-fr transition-colors ${\n                        expense.paid \n                          ? 'bg-green-100 text-fr-secondary hover:bg-green-200' \n                          : 'bg-red-100 text-fr-error hover:bg-red-200'\n                      }`}\n                    >\n                      {expense.paid ? (\n                        <CheckCircle className=\"w-5 h-5\" />\n                      ) : (\n                        <XCircle className=\"w-5 h-5\" />\n                      )}\n                    </button>\n\n                    <div className=\"flex-1\">\n                      <div className=\"flex items-center space-x-2\">\n                        <h3 className=\"font-medium text-fr-gray-900\">{expense.description}</h3>\n                        {category && (\n                          <span className=\"badge-info\">{category.name}</span>\n                        )}\n                        {expense.paid && (\n                          <span className=\"badge-success\">Pagado</span>\n                        )}\n                      </div>\n                      <div className=\"flex items-center space-x-4 mt-1 text-sm text-fr-gray-500\">\n                        {expense.due_date && (\n                          <span>Vence: {new Date(expense.due_date).toLocaleDateString('es-AR')}</span>\n                        )}\n                        <span>Creado: {new Date(expense.created_at).toLocaleDateString('es-AR')}</span>\n                      </div>\n                    </div>\n                  </div>\n\n                  <div className=\"flex items-center space-x-4\">\n                    <div className=\"text-right\">\n                      {expense.amount_paid > 0 && expense.amount_paid < expense.amount ? (\n                        // Pago parcial - mostrar total vs pendiente\n                        <div>\n                          <p className=\"font-semibold text-fr-gray-900 text-lg\">\n                            {formatAmount(expense.pending_amount || (expense.amount - (expense.amount_paid || 0)))}\n                          </p>\n                          <p className=\"text-sm text-fr-gray-500\">\n                            de {formatAmount(expense.amount)} total\n                          </p>\n                          <p className=\"text-xs text-fr-secondary\">\n                            Pagado: {formatAmount(expense.amount_paid || 0)}\n                          </p>\n                        </div>\n                      ) : (\n                        // Sin pagos parciales - mostrar solo el monto\n                        <p className=\"font-semibold text-fr-gray-900 text-lg\">\n                          {formatAmount(expense.amount)}\n                        </p>\n                      )}\n                      {expense.percentage && (\n                        <p className=\"text-sm text-fr-gray-500\">\n                          {formatPercentage(expense.percentage)} del total\n                        </p>\n                      )}\n                    </div>\n\n                    <div className=\"flex items-center space-x-2\">\n                      <button\n                        onClick={() => handleEdit(expense)}\n                        className=\"p-2 rounded-fr text-fr-gray-600 hover:bg-fr-gray-200 transition-colors\"\n                      >\n                        <Edit className=\"w-4 h-4\" />\n                      </button>\n                      <button\n                        onClick={() => handleDelete(expense)}\n                        className=\"p-2 rounded-fr text-fr-error hover:bg-red-100 transition-colors\"\n                      >\n                        <Trash2 className=\"w-4 h-4\" />\n                      </button>\n                    </div>\n                  </div>\n                </div>\n              );\n            })\n          )}\n        </div>\n      </div>\n\n      {/* Modal */}\n      {showModal && createPortal(\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[9999] p-4\">\n          <div className=\"bg-white rounded-fr-lg max-w-md w-full p-6\">\n            <h2 className=\"text-xl font-bold text-fr-gray-900 mb-6\">\n              {editingExpense ? 'Editar Gasto' : 'Nuevo Gasto'}\n            </h2>\n\n            <form onSubmit={handleSubmit} className=\"space-y-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-fr-gray-700 mb-2\">\n                  Descripci√≥n\n                </label>\n                <input\n                  type=\"text\"\n                  value={formData.description}\n                  onChange={(e) => setFormData({ ...formData, description: e.target.value })}\n                  className=\"input\"\n                  required\n                />\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-fr-gray-700 mb-2\">\n                  Monto\n                </label>\n                <input\n                  type=\"number\"\n                  step=\"0.01\"\n                  value={formData.amount}\n                  onChange={(e) => setFormData({ ...formData, amount: e.target.value })}\n                  className=\"input\"\n                  required\n                />\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-fr-gray-700 mb-2\">\n                  Categor√≠a\n                </label>\n                <select\n                  value={formData.category_id}\n                  onChange={(e) => setFormData({ ...formData, category_id: e.target.value })}\n                  className=\"input\"\n                >\n                  <option value=\"\">Seleccionar categor√≠a</option>\n                  {categories.map((category) => (\n                    <option key={category.id} value={category.id}>\n                      {category.name}\n                    </option>\n                  ))}\n                </select>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-fr-gray-700 mb-2\">\n                  Fecha de vencimiento\n                </label>\n                <input\n                  type=\"date\"\n                  value={formData.due_date}\n                  onChange={(e) => setFormData({ ...formData, due_date: e.target.value })}\n                  className=\"input\"\n                />\n              </div>\n\n              <div className=\"flex items-center\">\n                <input\n                  type=\"checkbox\"\n                  id=\"paid\"\n                  checked={formData.paid}\n                  onChange={(e) => setFormData({ ...formData, paid: e.target.checked })}\n                  className=\"mr-2\"\n                />\n                <label htmlFor=\"paid\" className=\"text-sm font-medium text-fr-gray-700\">\n                  Marcar como pagado\n                </label>\n              </div>\n\n              <div className=\"flex space-x-4 pt-4\">\n                <button\n                  type=\"button\"\n                  onClick={() => {\n                    setShowModal(false);\n                    setEditingExpense(null);\n                    setFormData({\n                      description: '',\n                      amount: '',\n                      category_id: '',\n                      due_date: '',\n                      paid: false,\n                    });\n                  }}\n                  className=\"btn-outline flex-1\"\n                >\n                  Cancelar\n                </button>\n                <button type=\"submit\" className=\"btn-primary flex-1\">\n                  {editingExpense ? 'Actualizar' : 'Crear'}\n                </button>\n              </div>\n            </form>\n          </div>\n        </div>,\n        document.body\n      )}\n\n      {/* Modal de Pago */}\n      {showPaymentModal && payingExpense && createPortal(\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[9999] p-4\">\n          <div className=\"bg-white rounded-fr-lg max-w-md w-full p-6\">\n            <h2 className=\"text-xl font-bold text-fr-gray-900 mb-6\">\n              Registrar Pago\n            </h2>\n\n            {/* Informaci√≥n del gasto */}\n            <div className=\"bg-fr-gray-50 rounded-fr p-4 mb-6\">\n              <h3 className=\"font-medium text-fr-gray-900 mb-2\">{payingExpense.description}</h3>\n              <div className=\"space-y-1\">\n                <p className=\"text-lg font-bold text-fr-gray-900\">\n                  Monto total: {formatCurrency(payingExpense.amount)}\n                </p>\n                {payingExpense.amount_paid > 0 && (\n                  <>\n                    <p className=\"text-sm text-fr-secondary\">\n                      Ya pagado: {formatCurrency(payingExpense.amount_paid)}\n                    </p>\n                    <p className=\"text-lg font-bold text-fr-accent\">\n                      Pendiente: {formatCurrency(payingExpense.pending_amount || (payingExpense.amount - payingExpense.amount_paid))}\n                    </p>\n                  </>\n                )}\n              </div>\n              {payingExpense.due_date && (\n                <p className=\"text-sm text-fr-gray-600 mt-1\">\n                  Vence: {new Date(payingExpense.due_date).toLocaleDateString('es-AR')}\n                </p>\n              )}\n            </div>\n\n            {/* Opciones de pago */}\n            <div className=\"space-y-4\">\n              {/* Pago Total */}\n              <button\n                onClick={() => handlePayment('total')}\n                className=\"w-full p-4 border-2 border-fr-secondary rounded-fr hover:bg-green-50 transition-colors text-left\"\n              >\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <h4 className=\"font-medium text-fr-gray-900\">üí∞ Pago Total</h4>\n                    <p className=\"text-sm text-fr-gray-600\">Marcar como completamente pagado</p>\n                  </div>\n                  <p className=\"font-bold text-fr-secondary\">\n                    {formatCurrency(payingExpense.pending_amount || (payingExpense.amount - (payingExpense.amount_paid || 0)))}\n                  </p>\n                </div>\n              </button>\n\n              {/* Pago Parcial */}\n              <div className=\"border-2 border-fr-accent rounded-fr p-4\">\n                <h4 className=\"font-medium text-fr-gray-900 mb-3\">üí∏ Pago Parcial</h4>\n                <div className=\"space-y-3\">\n                  <div>\n                    <label className=\"block text-sm font-medium text-fr-gray-700 mb-2\">\n                      Monto a pagar\n                    </label>\n                    <input\n                      type=\"number\"\n                      step=\"0.01\"\n                      max={payingExpense.pending_amount || (payingExpense.amount - (payingExpense.amount_paid || 0))}\n                      value={paymentAmount}\n                      onChange={(e) => setPaymentAmount(e.target.value)}\n                      className=\"input\"\n                      placeholder=\"0.00\"\n                    />\n                  </div>\n                  <div className=\"text-sm text-fr-gray-600\">\n                    <p>Quedar√≠an pendientes: <span className=\"font-medium\">\n                      {formatCurrency(Math.max(0, (payingExpense.pending_amount || (payingExpense.amount - (payingExpense.amount_paid || 0))) - (parseFloat(paymentAmount) || 0)))}\n                    </span></p>\n                  </div>\n                  <button\n                    onClick={() => handlePayment('partial')}\n                    disabled={!paymentAmount || parseFloat(paymentAmount) <= 0}\n                    className=\"w-full btn-primary disabled:opacity-50 disabled:cursor-not-allowed\"\n                  >\n                    Registrar Pago Parcial\n                  </button>\n                </div>\n              </div>\n            </div>\n\n            {/* Botones de acci√≥n */}\n            <div className=\"flex space-x-4 pt-6\">\n              <button\n                type=\"button\"\n                onClick={() => {\n                  setShowPaymentModal(false);\n                  setPayingExpense(null);\n                  setPaymentAmount('');\n                }}\n                className=\"btn-outline flex-1\"\n              >\n                Cancelar\n              </button>\n            </div>\n          </div>\n        </div>,\n        document.body\n      )}\n    </div>\n  );\n};\n\nexport default Expenses; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}