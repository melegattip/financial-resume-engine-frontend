{"ast":null,"code":"import _objectSpread from\"/Users/pmelegatti/Development/Financial Resume/financial-resume-engine-frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{TrendingUp,TrendingDown,DollarSign,PieChart,ArrowUpRight,ArrowDownRight,Calendar,CheckCircle,XCircle}from'lucide-react';import{AreaChart,Area,XAxis,YAxis,CartesianGrid,Tooltip,ResponsiveContainer,PieChart as RechartsPieChart,Pie,Cell}from'recharts';import{expensesAPI,incomesAPI,categoriesAPI,dashboardAPI,analyticsAPI,formatCurrency,formatDate,formatPercentage as formatPercentageUtil}from'../services/api';import{mockDashboardData,simulateNetworkDelay,createMockResponse}from'../services/mockData';import{usePeriod}from'../contexts/PeriodContext';import toast from'react-hot-toast';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Dashboard=()=>{const[loading,setLoading]=useState(true);const[sortBy,setSortBy]=useState('fecha');// nuevo estado para ordenamiento\nconst[data,setData]=useState({totalIncome:0,totalExpenses:0,balance:0,expenses:[],incomes:[],categories:[]});// Usar el contexto global de per√≠odo\nconst{selectedYear,selectedMonth,hasActiveFilters,balancesHidden,getFilterParams,getPeriodTitle,updateAvailableData}=usePeriod();useEffect(()=>{loadDashboardData();// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);// Recargar datos cuando cambien los filtros del contexto global\nuseEffect(()=>{loadDashboardData();// eslint-disable-next-line react-hooks/exhaustive-deps\n},[selectedMonth,selectedYear]);const loadDashboardData=async()=>{try{setLoading(true);// Obtener par√°metros de filtro del contexto global\nconst filterParams=getFilterParams();let data={};try{var _oldCategoriesRespons,_dashboard$Metrics,_dashboard$Metrics2,_dashboard$Metrics3;// Intentar usar los nuevos endpoints del backend\nconst[dashboardResponse,expensesResponse,incomesResponse,categoriesResponse,oldCategoriesResponse]=await Promise.all([dashboardAPI.overview(filterParams),analyticsAPI.expenses(_objectSpread(_objectSpread({},filterParams),{},{sort:'date',order:'desc',limit:50})),analyticsAPI.incomes(_objectSpread(_objectSpread({},filterParams),{},{sort:'date',order:'desc',limit:50})),analyticsAPI.categories(filterParams),categoriesAPI.list()// Mantener para dropdown de filtros\n]);// Extraer datos de las respuestas del backend\nconst dashboard=dashboardResponse.data||{};const expensesData=expensesResponse.data||{};const incomesData=incomesResponse.data||{};const categoriesData=categoriesResponse.data||{};const categoriesForDropdown=((_oldCategoriesRespons=oldCategoriesResponse.data)===null||_oldCategoriesRespons===void 0?void 0:_oldCategoriesRespons.data)||oldCategoriesResponse.data||[];// Normalizar datos del backend (convertir PascalCase a camelCase)\nconst normalizedExpenses=(expensesData.Expenses||[]).map(expense=>({id:expense.ID||expense.id,user_id:expense.UserID||expense.user_id,amount:expense.Amount||expense.amount,amount_paid:expense.AmountPaid||expense.amount_paid,pending_amount:expense.PendingAmount||expense.pending_amount,description:expense.Description||expense.description,category_id:expense.CategoryID||expense.category_id,paid:expense.Paid!==undefined?expense.Paid:expense.paid,due_date:expense.DueDate||expense.due_date,percentage:expense.PercentageOfIncome||expense.percentage,created_at:expense.CreatedAt||expense.created_at,updated_at:expense.UpdatedAt||expense.updated_at}));const normalizedIncomes=(incomesData.Incomes||[]).map(income=>({id:income.ID||income.id,user_id:income.UserID||income.user_id,amount:income.Amount||income.amount,description:income.Description||income.description,category_id:income.CategoryID||income.category_id,created_at:income.CreatedAt||income.created_at,updated_at:income.UpdatedAt||income.updated_at}));// Usar datos pre-calculados del backend\ndata={// M√©tricas del dashboard (pre-calculadas por backend)\ntotalIncome:((_dashboard$Metrics=dashboard.Metrics)===null||_dashboard$Metrics===void 0?void 0:_dashboard$Metrics.TotalIncome)||0,totalExpenses:((_dashboard$Metrics2=dashboard.Metrics)===null||_dashboard$Metrics2===void 0?void 0:_dashboard$Metrics2.TotalExpenses)||0,balance:((_dashboard$Metrics3=dashboard.Metrics)===null||_dashboard$Metrics3===void 0?void 0:_dashboard$Metrics3.Balance)||0,// Transacciones normalizadas con porcentajes calculados por backend\nexpenses:normalizedExpenses,incomes:normalizedIncomes,// Categor√≠as para dropdown de filtros\ncategories:Array.isArray(categoriesForDropdown)?categoriesForDropdown:[],// Datos adicionales del backend\ndashboardMetrics:dashboard.Metrics||{},expensesSummary:expensesData.Summary||{},categoriesAnalytics:categoriesData.Categories||[]};console.log('‚úÖ Usando nuevos endpoints del backend');}catch(newEndpointsError){var _expensesResponse$dat,_incomesResponse$data,_categoriesResponse$d;console.warn('‚ö†Ô∏è Nuevos endpoints no disponibles, usando endpoints legacy:',newEndpointsError.message);// Fallback a endpoints viejos con c√°lculos client-side\nconst[expensesResponse,incomesResponse,categoriesResponse]=await Promise.all([expensesAPI.list(),incomesAPI.list(),categoriesAPI.list()]);// Asegurar que siempre sean arrays\nconst expensesData=((_expensesResponse$dat=expensesResponse.data)===null||_expensesResponse$dat===void 0?void 0:_expensesResponse$dat.expenses)||expensesResponse.data||[];const incomesData=((_incomesResponse$data=incomesResponse.data)===null||_incomesResponse$data===void 0?void 0:_incomesResponse$data.incomes)||incomesResponse.data||[];const categoriesData=((_categoriesResponse$d=categoriesResponse.data)===null||_categoriesResponse$d===void 0?void 0:_categoriesResponse$d.data)||categoriesResponse.data||[];const expenses=Array.isArray(expensesData)?expensesData:[];const incomes=Array.isArray(incomesData)?incomesData:[];const categories=Array.isArray(categoriesData)?categoriesData:[];// Filtrar datos client-side si hay filtros activos\nconst filteredExpenses=filterDataByMonthAndYear(expenses,selectedMonth,selectedYear);const filteredIncomes=filterDataByMonthAndYear(incomes,selectedMonth,selectedYear);const totalExpenses=filteredExpenses.reduce((sum,expense)=>sum+expense.amount,0);const totalIncome=filteredIncomes.reduce((sum,income)=>sum+income.amount,0);data={totalIncome,totalExpenses,balance:totalIncome-totalExpenses,expenses:filteredExpenses,incomes:filteredIncomes,categories,dashboardMetrics:{},expensesSummary:{},categoriesAnalytics:[]};console.log('‚úÖ Usando endpoints legacy con c√°lculos client-side');}setData(data);// Actualizar datos disponibles en el contexto global\nupdateAvailableData(data.expenses,data.incomes);}catch(error){console.warn('‚ö†Ô∏è Todos los endpoints fallaron, usando datos mock:',error.message);// √öltimo fallback: usar datos mock para desarrollo\nawait simulateNetworkDelay(300);setData(mockDashboardData);updateAvailableData(mockDashboardData.expenses,mockDashboardData.incomes);toast.success('üöß Usando datos de ejemplo (backend no disponible)',{duration:3000});}finally{setLoading(false);}};const formatAmount=amount=>{if(balancesHidden)return'‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢';return formatCurrency(amount);};const formatPercentage=percentage=>{return formatPercentageUtil(percentage);};// Funci√≥n para filtrar datos client-side (fallback cuando nuevos endpoints no disponibles)\nconst filterDataByMonthAndYear=(dataArray,monthFilter,yearFilter)=>{if(!hasActiveFilters)return dataArray;return dataArray.filter(item=>{// Validar que tenga fecha v√°lida\nif(!item.created_at)return false;const itemDate=new Date(item.created_at);// Validar que la fecha sea v√°lida\nif(isNaN(itemDate.getTime()))return false;// Filtrar por a√±o si est√° seleccionado\nif(yearFilter&&itemDate.getFullYear().toString()!==yearFilter){return false;}// Filtrar por mes si est√° seleccionado\nif(monthFilter){const itemMonth=itemDate.toISOString().slice(0,7);return itemMonth===monthFilter;}return true;});};const formatMonthLabel=monthString=>{// Evitar problemas de zona horaria usando constructor num√©rico\nconst[year,month]=monthString.split('-');const date=new Date(parseInt(year),parseInt(month)-1,1);// month es 0-indexed\nconst formatted=date.toLocaleDateString('es-AR',{year:'numeric',month:'long'});// Capitalizar la primera letra del mes\nconst capitalized=formatted.charAt(0).toUpperCase()+formatted.slice(1);return capitalized;};// Funci√≥n para obtener colores por categor√≠a\nconst getCategoryColor=categoryId=>{const colors=[{bg:'bg-blue-100',border:'border-blue-400',text:'text-blue-700'},{bg:'bg-green-100',border:'border-green-400',text:'text-green-700'},{bg:'bg-yellow-100',border:'border-yellow-400',text:'text-yellow-700'},{bg:'bg-purple-100',border:'border-purple-400',text:'text-purple-700'},{bg:'bg-pink-100',border:'border-pink-400',text:'text-pink-700'},{bg:'bg-indigo-100',border:'border-indigo-400',text:'text-indigo-700'},{bg:'bg-cyan-100',border:'border-cyan-400',text:'text-cyan-700'},{bg:'bg-orange-100',border:'border-orange-400',text:'text-orange-700'}];if(!categoryId){return{bg:'bg-gray-100',border:'border-gray-400',text:'text-gray-700'};}// Usar el hash del categoryId para asignar colores consistentes\nlet hash=0;for(let i=0;i<categoryId.length;i++){hash=categoryId.charCodeAt(i)+((hash<<5)-hash);}const colorIndex=Math.abs(hash)%colors.length;return colors[colorIndex];};// Usar datos de categor√≠as pre-calculados del backend\nconst calculateCategoryData=()=>{if(!data.categoriesAnalytics||!data.categoriesAnalytics.length){return[];}// Los datos ya vienen del backend con c√°lculos completos\nconst colors=['#009ee3','#00a650','#ff6900','#e53e3e','#6b7280','#8b5cf6','#f59e0b'];return data.categoriesAnalytics.map((category,index)=>({name:category.Name,value:category.Percentage,amount:category.TotalAmount,color:colors[index%colors.length]})).filter(item=>item.value>0);// Solo mostrar categor√≠as con gastos\n};// Datos simplificados del gr√°fico usando m√©tricas del backend\nconst calculateChartData=()=>{let periodLabel='Total';if(selectedMonth&&selectedYear){periodLabel=formatMonthLabel(selectedMonth);}else if(selectedMonth){periodLabel=new Date(selectedMonth+'-01').toLocaleDateString('es-AR',{month:'short'});}else if(selectedYear){periodLabel=selectedYear;}return[{name:periodLabel,ingresos:data.totalIncome,gastos:data.totalExpenses}];};// Datos para los gr√°ficos\nconst chartData=calculateChartData();const pieData=calculateCategoryData();// Funci√≥n para ordenar transacciones\nconst sortTransactions=(transactions,sortType)=>{const sorted=[...transactions];switch(sortType){case'fecha':return sorted.sort((a,b)=>{const dateA=new Date(a.created_at);const dateB=new Date(b.created_at);// Manejar fechas inv√°lidas - ponerlas al final\nif(isNaN(dateA.getTime())&&isNaN(dateB.getTime()))return 0;if(isNaN(dateA.getTime()))return 1;if(isNaN(dateB.getTime()))return-1;return dateB-dateA;});case'monto':return sorted.sort((a,b)=>{const amountA=Number(a.amount)||0;const amountB=Number(b.amount)||0;return amountB-amountA;});case'categoria':return sorted.sort((a,b)=>{var _data$categories$find,_data$categories$find2;const categoryA=((_data$categories$find=data.categories.find(c=>c.id===a.category_id))===null||_data$categories$find===void 0?void 0:_data$categories$find.name)||'Sin categor√≠a';const categoryB=((_data$categories$find2=data.categories.find(c=>c.id===b.category_id))===null||_data$categories$find2===void 0?void 0:_data$categories$find2.name)||'Sin categor√≠a';return categoryA.localeCompare(categoryB);});default:return sorted;}};if(loading){return/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-center h-64\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"spinner\"}),/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 text-fr-gray-600\",children:\"Cargando dashboard...\"})]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 md:gap-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 min-w-0\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium text-fr-gray-600\",children:\"Balance Total\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xl lg:text-2xl font-bold \".concat(data.balance>=0?'text-fr-secondary':'text-fr-error',\" break-words\"),children:formatAmount(data.balance)})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex-shrink-0 p-2 lg:p-3 rounded-fr \".concat(data.balance>=0?'bg-green-100':'bg-red-100',\" ml-2\"),children:/*#__PURE__*/_jsx(DollarSign,{className:\"w-5 h-5 lg:w-6 lg:h-6 \".concat(data.balance>=0?'text-fr-secondary':'text-fr-error')})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-3 flex items-center\",children:[data.balance>=0?/*#__PURE__*/_jsx(ArrowUpRight,{className:\"w-4 h-4 text-fr-secondary mr-1 flex-shrink-0\"}):/*#__PURE__*/_jsx(ArrowDownRight,{className:\"w-4 h-4 text-fr-error mr-1 flex-shrink-0\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm \".concat(data.balance>=0?'text-fr-secondary':'text-fr-error'),children:data.balance>=0?'Positivo':'Negativo'})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 min-w-0\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium text-fr-gray-600\",children:\"Total Ingresos\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xl lg:text-2xl font-bold text-fr-secondary break-words\",children:formatAmount(data.totalIncome)})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex-shrink-0 p-2 lg:p-3 rounded-fr bg-green-100 ml-2\",children:/*#__PURE__*/_jsx(TrendingUp,{className:\"w-5 h-5 lg:w-6 lg:h-6 text-fr-secondary\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-3 flex items-center\",children:[/*#__PURE__*/_jsx(TrendingUp,{className:\"w-4 h-4 text-fr-secondary mr-1 flex-shrink-0\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm text-fr-gray-500\",children:[data.incomes.length,\" \",data.incomes.length===1?'ingreso':'ingresos',\" registrados\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 min-w-0\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium text-fr-gray-600\",children:\"Total Gastos\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xl lg:text-2xl font-bold text-fr-gray-900 break-words\",children:formatAmount(data.totalExpenses)})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex-shrink-0 p-2 lg:p-3 rounded-fr bg-gray-100 ml-2\",children:/*#__PURE__*/_jsx(TrendingDown,{className:\"w-5 h-5 lg:w-6 lg:h-6 text-fr-gray-900\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-3 flex items-center\",children:[/*#__PURE__*/_jsx(TrendingDown,{className:\"w-4 h-4 text-fr-gray-900 mr-1 flex-shrink-0\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm text-fr-gray-500\",children:[data.expenses.length,\" \",data.expenses.length===1?'gasto':'gastos',\" registrados\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 min-w-0\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium text-fr-gray-600\",children:\"Gastos Pendientes\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xl lg:text-2xl font-bold text-fr-gray-900\",children:data.expenses.filter(e=>!e.paid).length})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex-shrink-0 p-2 lg:p-3 rounded-fr bg-gray-100 ml-2\",children:/*#__PURE__*/_jsx(Calendar,{className:\"w-5 h-5 lg:w-6 lg:h-6 text-fr-gray-900\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-3\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm text-fr-gray-500\",children:[formatAmount(data.expenses.filter(e=>!e.paid).reduce((sum,e)=>sum+e.amount,0)),\" por pagar\"]})})]})]}),hasActiveFilters&&(data.expenses.length>0||data.incomes.length>0)&&/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-6\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-lg font-semibold text-fr-gray-900\",children:[\"\\uD83D\\uDCB0 Transacciones de \",getPeriodTitle()]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col md:flex-row md:items-center md:space-x-4 space-y-4 md:space-y-0\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-sm font-medium text-fr-gray-600\",children:\"Ordenar por:\"}),/*#__PURE__*/_jsxs(\"select\",{value:sortBy,onChange:e=>setSortBy(e.target.value),className:\"text-sm border border-fr-gray-300 rounded-fr px-3 py-1 focus:outline-none focus:ring-2 focus:ring-fr-primary focus:border-transparent\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"fecha\",children:\"Fecha\"}),/*#__PURE__*/_jsx(\"option\",{value:\"monto\",children:\"Monto\"}),/*#__PURE__*/_jsx(\"option\",{value:\"categoria\",children:\"Categor\\xEDa\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-4 text-sm\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-3 h-3 bg-fr-error rounded-full mr-2\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-fr-gray-600\",children:[\"Gastos (\",data.expenses.length,\")\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-3 h-3 bg-fr-secondary rounded-full mr-2\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-fr-gray-600\",children:[\"Ingresos (\",data.incomes.length,\")\"]})]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative grid grid-cols-1 md:grid-cols-2 gap-4 lg:gap-6 xl:gap-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3 mb-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"h4\",{className:\"font-semibold text-fr-gray-900 flex items-center\",children:[/*#__PURE__*/_jsx(TrendingDown,{className:\"w-5 h-5 mr-2\"}),\"Gastos\"]}),/*#__PURE__*/_jsx(\"span\",{className:\"text-lg font-bold text-fr-gray-900\",children:formatAmount(data.totalExpenses)})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3 max-h-96 overflow-y-auto\",children:data.expenses.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-8 text-fr-gray-500\",children:[/*#__PURE__*/_jsx(TrendingDown,{className:\"w-8 h-8 mx-auto mb-2 opacity-50\"}),/*#__PURE__*/_jsx(\"p\",{children:\"No hay gastos en este per\\xEDodo\"})]}):sortTransactions(data.expenses,sortBy).map((expense,index)=>{const category=data.categories.find(c=>c.id===expense.category_id);const color=getCategoryColor(expense.category_id);return/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between p-3 rounded-fr bg-white border border-fr-gray-100 hover:shadow-sm transition-shadow\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start space-x-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex-shrink-0 mt-1\",children:expense.paid?/*#__PURE__*/_jsx(CheckCircle,{className:\"w-5 h-5 text-fr-secondary\"}):/*#__PURE__*/_jsx(XCircle,{className:\"w-5 h-5 text-fr-error\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-medium text-fr-gray-900 text-sm\",children:expense.description}),!expense.paid&&/*#__PURE__*/_jsx(\"span\",{className:\"badge-error text-xs\",children:\"Pendiente\"}),category&&/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-1 rounded text-xs font-medium \".concat(color.bg,\" \").concat(color.text,\" border \").concat(color.border),children:category.name})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-fr-gray-500 mt-1\",children:[new Date(expense.created_at).toLocaleDateString('es-AR'),expense.due_date&&/*#__PURE__*/_jsxs(\"span\",{className:\"ml-2\",children:[\"\\u2022 Vence: \",new Date(expense.due_date).toLocaleDateString('es-AR')]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-right ml-3\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"font-semibold text-fr-gray-900\",children:[\"-\",formatAmount(expense.amount)]}),expense.percentage&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-fr-gray-500\",children:[formatPercentage(expense.percentage),\" del total\"]}),expense.amount_paid>0&&expense.amount_paid<expense.amount&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-fr-gray-500\",children:[\"Pagado: \",formatAmount(expense.amount_paid)]})]})]},expense.id||index);})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"hidden lg:block absolute left-1/2 top-4 bottom-4 w-px bg-gradient-to-b from-transparent via-fr-gray-200 to-transparent transform -translate-x-1/2\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3 mb-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"h4\",{className:\"font-semibold text-fr-secondary flex items-center\",children:[/*#__PURE__*/_jsx(TrendingUp,{className:\"w-5 h-5 mr-2\"}),\"Ingresos\"]}),/*#__PURE__*/_jsx(\"span\",{className:\"text-lg font-bold text-fr-secondary\",children:formatAmount(data.totalIncome)})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3 max-h-96 overflow-y-auto\",children:data.incomes.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-8 text-fr-gray-500\",children:[/*#__PURE__*/_jsx(TrendingUp,{className:\"w-8 h-8 mx-auto mb-2 opacity-50\"}),/*#__PURE__*/_jsx(\"p\",{children:\"No hay ingresos en este per\\xEDodo\"})]}):sortTransactions(data.incomes,sortBy).map((income,index)=>{const color=getCategoryColor(income.category_id);const category=data.categories.find(c=>c.id===income.category_id);return/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between p-3 rounded-fr bg-white border border-fr-gray-100 hover:shadow-sm transition-shadow\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-medium text-fr-gray-900 text-sm\",children:income.description}),category&&/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-1 rounded text-xs font-medium \".concat(color.bg,\" \").concat(color.text,\" border \").concat(color.border),children:category.name})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-fr-gray-500 mt-1\",children:new Date(income.created_at).toLocaleDateString('es-AR')})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-right ml-3\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"font-semibold text-fr-secondary\",children:[\"+\",formatAmount(income.amount)]}),income.percentage&&/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-fr-gray-500\",children:formatPercentage(income.percentage)})]})]},income.id||index);})})]})]}),(data.expenses.length>0||data.incomes.length>0)&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-6 pt-4 border-t border-fr-gray-200\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-fr-gray-600\",children:\"Total gastos:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-right\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-bold text-fr-gray-900\",children:formatAmount(data.totalExpenses)}),data.totalIncome>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-fr-gray-500\",children:[(data.totalExpenses/data.totalIncome*100).toFixed(1),\"% de ingresos\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-fr-gray-600\",children:\"Total ingresos:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-right\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-bold text-fr-secondary\",children:formatAmount(data.totalIncome)}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-fr-gray-500\",children:\"100% base\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between pt-3 border-t border-fr-gray-200\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-fr-gray-600\",children:\"Balance del per\\xEDodo:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-xl font-bold \".concat(data.balance>=0?'text-fr-secondary':'text-fr-error'),children:[data.balance>=0?'+':'',formatAmount(data.balance)]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4 lg:gap-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-fr-gray-900\",children:hasActiveFilters?\"Datos de \".concat(getPeriodTitle()):'Tendencia Mensual'}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-fr-gray-500 mt-1\",children:hasActiveFilters?'Resumen del per√≠odo seleccionado':'Datos del mes actual (hist√≥rico pr√≥ximamente)'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-wrap items-center gap-4 text-sm\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-3 h-3 bg-fr-secondary rounded-full mr-2\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-fr-gray-600\",children:\"Ingresos\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-3 h-3 bg-fr-accent rounded-full mr-2\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-fr-gray-600\",children:\"Gastos\"})]})]})]}),/*#__PURE__*/_jsx(ResponsiveContainer,{width:\"100%\",height:250,children:/*#__PURE__*/_jsxs(AreaChart,{data:chartData,children:[/*#__PURE__*/_jsx(CartesianGrid,{strokeDasharray:\"3 3\",stroke:\"#e5e7eb\"}),/*#__PURE__*/_jsx(XAxis,{dataKey:\"name\",stroke:\"#6b7280\"}),/*#__PURE__*/_jsx(YAxis,{stroke:\"#6b7280\"}),/*#__PURE__*/_jsx(Tooltip,{formatter:value=>[formatCurrency(value)],contentStyle:{backgroundColor:'white',border:'1px solid #e5e7eb',borderRadius:'8px',boxShadow:'0 4px 12px 0 rgba(0, 0, 0, 0.15)'}}),/*#__PURE__*/_jsx(Area,{type:\"monotone\",dataKey:\"ingresos\",stackId:\"1\",stroke:\"#00a650\",fill:\"#00a650\",fillOpacity:0.6}),/*#__PURE__*/_jsx(Area,{type:\"monotone\",dataKey:\"gastos\",stackId:\"2\",stroke:\"#ff6900\",fill:\"#ff6900\",fillOpacity:0.6})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-lg font-semibold text-fr-gray-900 mb-6\",children:[\"Gastos por Categor\\xEDa\",hasActiveFilters&&\" - \".concat(getPeriodTitle())]}),pieData.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center\",children:/*#__PURE__*/_jsx(ResponsiveContainer,{width:\"100%\",height:250,children:/*#__PURE__*/_jsxs(RechartsPieChart,{children:[/*#__PURE__*/_jsx(Pie,{data:pieData,cx:\"50%\",cy:\"50%\",innerRadius:60,outerRadius:120,paddingAngle:5,dataKey:\"value\",label:_ref=>{let{name,value}=_ref;return\"\".concat(name,\": \").concat(value,\"%\");},labelLine:false,children:pieData.map((entry,index)=>/*#__PURE__*/_jsx(Cell,{fill:entry.color},\"cell-\".concat(index)))}),/*#__PURE__*/_jsx(Tooltip,{formatter:(value,name,props)=>[\"\".concat(value,\"% (\").concat(formatCurrency(props.payload.amount),\")\"),'Porcentaje'],contentStyle:{backgroundColor:'white',border:'1px solid #e5e7eb',borderRadius:'8px',boxShadow:'0 4px 12px 0 rgba(0, 0, 0, 0.15)'}})]})})}):/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center justify-center h-64 text-center\",children:[/*#__PURE__*/_jsx(PieChart,{className:\"w-12 h-12 text-fr-gray-400 mb-4\"}),/*#__PURE__*/_jsx(\"h4\",{className:\"text-lg font-medium text-fr-gray-600 mb-2\",children:\"No hay gastos por categor\\xEDas\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-fr-gray-500\",children:\"Los gastos aparecer\\xE1n aqu\\xED una vez que agregues algunos gastos con categor\\xEDas\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-fr-gray-900\",children:\"Transacciones Recientes\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-ghost\",children:\"Ver todas\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-4\",children:(()=>{const allTransactions=[...data.expenses.slice(0,3),...data.incomes.slice(0,2)];const sortedTransactions=allTransactions.sort((a,b)=>new Date(b.created_at)-new Date(a.created_at)).slice(0,5);return sortedTransactions.map((transaction,index)=>{const isExpense=transaction.hasOwnProperty('paid');const color=getCategoryColor(transaction.category_id);const category=data.categories.find(c=>c.id===transaction.category_id);return/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between p-4 rounded-fr bg-fr-gray-50 border-l-4 \".concat(color.border||(isExpense?'border-fr-gray-900':'border-fr-secondary')),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-2 rounded-fr \".concat(isExpense?'bg-gray-100':'bg-green-100'),children:isExpense?/*#__PURE__*/_jsx(TrendingDown,{className:\"w-4 h-4 text-fr-gray-900\"}):/*#__PURE__*/_jsx(TrendingUp,{className:\"w-4 h-4 text-fr-secondary\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-medium text-fr-gray-900\",children:transaction.description}),isExpense&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-1\",children:[transaction.paid?/*#__PURE__*/_jsx(CheckCircle,{className:\"w-4 h-4 text-fr-secondary\"}):/*#__PURE__*/_jsx(XCircle,{className:\"w-4 h-4 text-fr-error\"}),!transaction.paid&&/*#__PURE__*/_jsx(\"span\",{className:\"badge-error text-xs\",children:\"Pendiente\"})]}),category&&/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-1 rounded text-xs font-medium \".concat(color.bg,\" \").concat(color.text,\" border \").concat(color.border),children:category.name})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-fr-gray-500\",children:transaction.created_at?formatDate(transaction.created_at):'Fecha no disponible'})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-right\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"font-semibold \".concat(isExpense?'text-fr-gray-900':'text-fr-secondary'),children:[isExpense?'-':'+',formatAmount(transaction.amount)]}),transaction.percentage&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-fr-gray-500\",children:[formatPercentage(transaction.percentage),\" del total\"]})]})]},index);});})()})]})]});};export default Dashboard;","map":{"version":3,"names":["React","useState","useEffect","TrendingUp","TrendingDown","DollarSign","PieChart","ArrowUpRight","ArrowDownRight","Calendar","CheckCircle","XCircle","AreaChart","Area","XAxis","YAxis","CartesianGrid","Tooltip","ResponsiveContainer","RechartsPieChart","Pie","Cell","expensesAPI","incomesAPI","categoriesAPI","dashboardAPI","analyticsAPI","formatCurrency","formatDate","formatPercentage","formatPercentageUtil","mockDashboardData","simulateNetworkDelay","createMockResponse","usePeriod","toast","jsx","_jsx","jsxs","_jsxs","Dashboard","loading","setLoading","sortBy","setSortBy","data","setData","totalIncome","totalExpenses","balance","expenses","incomes","categories","selectedYear","selectedMonth","hasActiveFilters","balancesHidden","getFilterParams","getPeriodTitle","updateAvailableData","loadDashboardData","filterParams","_oldCategoriesRespons","_dashboard$Metrics","_dashboard$Metrics2","_dashboard$Metrics3","dashboardResponse","expensesResponse","incomesResponse","categoriesResponse","oldCategoriesResponse","Promise","all","overview","_objectSpread","sort","order","limit","list","dashboard","expensesData","incomesData","categoriesData","categoriesForDropdown","normalizedExpenses","Expenses","map","expense","id","ID","user_id","UserID","amount","Amount","amount_paid","AmountPaid","pending_amount","PendingAmount","description","Description","category_id","CategoryID","paid","Paid","undefined","due_date","DueDate","percentage","PercentageOfIncome","created_at","CreatedAt","updated_at","UpdatedAt","normalizedIncomes","Incomes","income","Metrics","TotalIncome","TotalExpenses","Balance","Array","isArray","dashboardMetrics","expensesSummary","Summary","categoriesAnalytics","Categories","console","log","newEndpointsError","_expensesResponse$dat","_incomesResponse$data","_categoriesResponse$d","warn","message","filteredExpenses","filterDataByMonthAndYear","filteredIncomes","reduce","sum","error","success","duration","formatAmount","dataArray","monthFilter","yearFilter","filter","item","itemDate","Date","isNaN","getTime","getFullYear","toString","itemMonth","toISOString","slice","formatMonthLabel","monthString","year","month","split","date","parseInt","formatted","toLocaleDateString","capitalized","charAt","toUpperCase","getCategoryColor","categoryId","colors","bg","border","text","hash","i","length","charCodeAt","colorIndex","Math","abs","calculateCategoryData","category","index","name","Name","value","Percentage","TotalAmount","color","calculateChartData","periodLabel","ingresos","gastos","chartData","pieData","sortTransactions","transactions","sortType","sorted","a","b","dateA","dateB","amountA","Number","amountB","_data$categories$find","_data$categories$find2","categoryA","find","c","categoryB","localeCompare","className","children","concat","e","onChange","target","toFixed","width","height","strokeDasharray","stroke","dataKey","formatter","contentStyle","backgroundColor","borderRadius","boxShadow","type","stackId","fill","fillOpacity","cx","cy","innerRadius","outerRadius","paddingAngle","label","_ref","labelLine","entry","props","payload","allTransactions","sortedTransactions","transaction","isExpense","hasOwnProperty"],"sources":["/Users/pmelegatti/Development/Financial Resume/financial-resume-engine-frontend/src/pages/Dashboard.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { \n  TrendingUp, \n  TrendingDown, \n  DollarSign, \n  PieChart,\n  ArrowUpRight,\n  ArrowDownRight,\n  Calendar,\n  CheckCircle,\n  XCircle\n} from 'lucide-react';\nimport { \n  AreaChart, \n  Area, \n  XAxis, \n  YAxis, \n  CartesianGrid, \n  Tooltip, \n  ResponsiveContainer,\n  PieChart as RechartsPieChart,\n  Pie,\n  Cell\n} from 'recharts';\nimport { expensesAPI, incomesAPI, categoriesAPI, dashboardAPI, analyticsAPI, formatCurrency, formatDate, formatPercentage as formatPercentageUtil } from '../services/api';\nimport { mockDashboardData, simulateNetworkDelay, createMockResponse } from '../services/mockData';\nimport { usePeriod } from '../contexts/PeriodContext';\nimport toast from 'react-hot-toast';\n\nconst Dashboard = () => {\n  const [loading, setLoading] = useState(true);\n  const [sortBy, setSortBy] = useState('fecha'); // nuevo estado para ordenamiento\n  const [data, setData] = useState({\n    totalIncome: 0,\n    totalExpenses: 0,\n    balance: 0,\n    expenses: [],\n    incomes: [],\n    categories: [],\n  });\n\n  // Usar el contexto global de per√≠odo\n  const {\n    selectedYear,\n    selectedMonth,\n    hasActiveFilters,\n    balancesHidden,\n    getFilterParams,\n    getPeriodTitle,\n    updateAvailableData,\n  } = usePeriod();\n\n  useEffect(() => {\n    loadDashboardData();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  // Recargar datos cuando cambien los filtros del contexto global\n  useEffect(() => {\n    loadDashboardData();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [selectedMonth, selectedYear]);\n\n\n\n  const loadDashboardData = async () => {\n    try {\n      setLoading(true);\n      \n      // Obtener par√°metros de filtro del contexto global\n      const filterParams = getFilterParams();\n\n      let data = {};\n\n      try {\n        // Intentar usar los nuevos endpoints del backend\n        const [dashboardResponse, expensesResponse, incomesResponse, categoriesResponse, oldCategoriesResponse] = await Promise.all([\n          dashboardAPI.overview(filterParams),\n          analyticsAPI.expenses({ ...filterParams, sort: 'date', order: 'desc', limit: 50 }),\n          analyticsAPI.incomes({ ...filterParams, sort: 'date', order: 'desc', limit: 50 }),\n          analyticsAPI.categories(filterParams),\n          categoriesAPI.list(), // Mantener para dropdown de filtros\n        ]);\n\n        // Extraer datos de las respuestas del backend\n        const dashboard = dashboardResponse.data || {};\n        const expensesData = expensesResponse.data || {};\n        const incomesData = incomesResponse.data || {};\n        const categoriesData = categoriesResponse.data || {};\n        const categoriesForDropdown = oldCategoriesResponse.data?.data || oldCategoriesResponse.data || [];\n\n\n\n        // Normalizar datos del backend (convertir PascalCase a camelCase)\n        const normalizedExpenses = (expensesData.Expenses || []).map(expense => ({\n          id: expense.ID || expense.id,\n          user_id: expense.UserID || expense.user_id,\n          amount: expense.Amount || expense.amount,\n          amount_paid: expense.AmountPaid || expense.amount_paid,\n          pending_amount: expense.PendingAmount || expense.pending_amount,\n          description: expense.Description || expense.description,\n          category_id: expense.CategoryID || expense.category_id,\n          paid: expense.Paid !== undefined ? expense.Paid : expense.paid,\n          due_date: expense.DueDate || expense.due_date,\n          percentage: expense.PercentageOfIncome || expense.percentage,\n          created_at: expense.CreatedAt || expense.created_at,\n          updated_at: expense.UpdatedAt || expense.updated_at\n        }));\n\n        const normalizedIncomes = (incomesData.Incomes || []).map(income => ({\n          id: income.ID || income.id,\n          user_id: income.UserID || income.user_id,\n          amount: income.Amount || income.amount,\n          description: income.Description || income.description,\n          category_id: income.CategoryID || income.category_id,\n          created_at: income.CreatedAt || income.created_at,\n          updated_at: income.UpdatedAt || income.updated_at\n        }));\n\n        // Usar datos pre-calculados del backend\n        data = {\n          // M√©tricas del dashboard (pre-calculadas por backend)\n          totalIncome: dashboard.Metrics?.TotalIncome || 0,\n          totalExpenses: dashboard.Metrics?.TotalExpenses || 0,\n          balance: dashboard.Metrics?.Balance || 0,\n          \n          // Transacciones normalizadas con porcentajes calculados por backend\n          expenses: normalizedExpenses,\n          incomes: normalizedIncomes,\n          \n          // Categor√≠as para dropdown de filtros\n          categories: Array.isArray(categoriesForDropdown) ? categoriesForDropdown : [],\n          \n          // Datos adicionales del backend\n          dashboardMetrics: dashboard.Metrics || {},\n          expensesSummary: expensesData.Summary || {},\n          categoriesAnalytics: categoriesData.Categories || [],\n        };\n\n        console.log('‚úÖ Usando nuevos endpoints del backend');\n      } catch (newEndpointsError) {\n        console.warn('‚ö†Ô∏è Nuevos endpoints no disponibles, usando endpoints legacy:', newEndpointsError.message);\n        \n        // Fallback a endpoints viejos con c√°lculos client-side\n        const [expensesResponse, incomesResponse, categoriesResponse] = await Promise.all([\n          expensesAPI.list(),\n          incomesAPI.list(),\n          categoriesAPI.list(),\n        ]);\n\n        // Asegurar que siempre sean arrays\n        const expensesData = expensesResponse.data?.expenses || expensesResponse.data || [];\n        const incomesData = incomesResponse.data?.incomes || incomesResponse.data || [];\n        const categoriesData = categoriesResponse.data?.data || categoriesResponse.data || [];\n        \n        const expenses = Array.isArray(expensesData) ? expensesData : [];\n        const incomes = Array.isArray(incomesData) ? incomesData : [];\n        const categories = Array.isArray(categoriesData) ? categoriesData : [];\n\n        // Filtrar datos client-side si hay filtros activos\n        const filteredExpenses = filterDataByMonthAndYear(expenses, selectedMonth, selectedYear);\n        const filteredIncomes = filterDataByMonthAndYear(incomes, selectedMonth, selectedYear);\n\n        const totalExpenses = filteredExpenses.reduce((sum, expense) => sum + expense.amount, 0);\n        const totalIncome = filteredIncomes.reduce((sum, income) => sum + income.amount, 0);\n\n        data = {\n          totalIncome,\n          totalExpenses,\n          balance: totalIncome - totalExpenses,\n          expenses: filteredExpenses,\n          incomes: filteredIncomes,\n          categories,\n          dashboardMetrics: {},\n          expensesSummary: {},\n          categoriesAnalytics: [],\n        };\n\n        console.log('‚úÖ Usando endpoints legacy con c√°lculos client-side');\n      }\n\n      setData(data);\n      \n      // Actualizar datos disponibles en el contexto global\n      updateAvailableData(data.expenses, data.incomes);\n    } catch (error) {\n      console.warn('‚ö†Ô∏è Todos los endpoints fallaron, usando datos mock:', error.message);\n      \n      // √öltimo fallback: usar datos mock para desarrollo\n      await simulateNetworkDelay(300);\n      setData(mockDashboardData);\n      updateAvailableData(mockDashboardData.expenses, mockDashboardData.incomes);\n      \n      toast.success('üöß Usando datos de ejemplo (backend no disponible)', {\n        duration: 3000,\n      });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const formatAmount = (amount) => {\n    if (balancesHidden) return '‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢';\n    return formatCurrency(amount);\n  };\n\n  const formatPercentage = (percentage) => {\n    return formatPercentageUtil(percentage);\n  };\n\n  // Funci√≥n para filtrar datos client-side (fallback cuando nuevos endpoints no disponibles)\n  const filterDataByMonthAndYear = (dataArray, monthFilter, yearFilter) => {\n    if (!hasActiveFilters) return dataArray;\n    \n    return dataArray.filter(item => {\n      // Validar que tenga fecha v√°lida\n      if (!item.created_at) return false;\n      \n      const itemDate = new Date(item.created_at);\n      \n      // Validar que la fecha sea v√°lida\n      if (isNaN(itemDate.getTime())) return false;\n      \n      // Filtrar por a√±o si est√° seleccionado\n      if (yearFilter && itemDate.getFullYear().toString() !== yearFilter) {\n        return false;\n      }\n      \n      // Filtrar por mes si est√° seleccionado\n      if (monthFilter) {\n        const itemMonth = itemDate.toISOString().slice(0, 7);\n        return itemMonth === monthFilter;\n      }\n      \n      return true;\n    });\n  };\n  \n\n\n  const formatMonthLabel = (monthString) => {\n    // Evitar problemas de zona horaria usando constructor num√©rico\n    const [year, month] = monthString.split('-');\n    const date = new Date(parseInt(year), parseInt(month) - 1, 1); // month es 0-indexed\n    const formatted = date.toLocaleDateString('es-AR', { \n      year: 'numeric', \n      month: 'long' \n    });\n    // Capitalizar la primera letra del mes\n    const capitalized = formatted.charAt(0).toUpperCase() + formatted.slice(1);\n    return capitalized;\n  };\n\n\n\n  // Funci√≥n para obtener colores por categor√≠a\n  const getCategoryColor = (categoryId) => {\n    const colors = [\n      { bg: 'bg-blue-100', border: 'border-blue-400', text: 'text-blue-700' },\n      { bg: 'bg-green-100', border: 'border-green-400', text: 'text-green-700' },\n      { bg: 'bg-yellow-100', border: 'border-yellow-400', text: 'text-yellow-700' },\n      { bg: 'bg-purple-100', border: 'border-purple-400', text: 'text-purple-700' },\n      { bg: 'bg-pink-100', border: 'border-pink-400', text: 'text-pink-700' },\n      { bg: 'bg-indigo-100', border: 'border-indigo-400', text: 'text-indigo-700' },\n      { bg: 'bg-cyan-100', border: 'border-cyan-400', text: 'text-cyan-700' },\n      { bg: 'bg-orange-100', border: 'border-orange-400', text: 'text-orange-700' },\n    ];\n    \n    if (!categoryId) {\n      return { bg: 'bg-gray-100', border: 'border-gray-400', text: 'text-gray-700' };\n    }\n    \n    // Usar el hash del categoryId para asignar colores consistentes\n    let hash = 0;\n    for (let i = 0; i < categoryId.length; i++) {\n      hash = categoryId.charCodeAt(i) + ((hash << 5) - hash);\n    }\n    const colorIndex = Math.abs(hash) % colors.length;\n    return colors[colorIndex];\n  };\n\n  // Usar datos de categor√≠as pre-calculados del backend\n  const calculateCategoryData = () => {\n    if (!data.categoriesAnalytics || !data.categoriesAnalytics.length) {\n      return [];\n    }\n\n    // Los datos ya vienen del backend con c√°lculos completos\n    const colors = ['#009ee3', '#00a650', '#ff6900', '#e53e3e', '#6b7280', '#8b5cf6', '#f59e0b'];\n    \n    return data.categoriesAnalytics.map((category, index) => ({\n      name: category.Name,\n      value: category.Percentage,\n      amount: category.TotalAmount,\n      color: colors[index % colors.length]\n    })).filter(item => item.value > 0); // Solo mostrar categor√≠as con gastos\n  };\n\n  // Datos simplificados del gr√°fico usando m√©tricas del backend\n  const calculateChartData = () => {\n    let periodLabel = 'Total';\n    \n    if (selectedMonth && selectedYear) {\n      periodLabel = formatMonthLabel(selectedMonth);\n    } else if (selectedMonth) {\n      periodLabel = new Date(selectedMonth + '-01').toLocaleDateString('es-AR', { month: 'short' });\n    } else if (selectedYear) {\n      periodLabel = selectedYear;\n    }\n    \n    return [{\n      name: periodLabel,\n      ingresos: data.totalIncome,\n      gastos: data.totalExpenses\n    }];\n  };\n\n  // Datos para los gr√°ficos\n  const chartData = calculateChartData();\n  const pieData = calculateCategoryData();\n\n  // Funci√≥n para ordenar transacciones\n  const sortTransactions = (transactions, sortType) => {\n    const sorted = [...transactions];\n    \n    switch (sortType) {\n      case 'fecha':\n        return sorted.sort((a, b) => {\n          const dateA = new Date(a.created_at);\n          const dateB = new Date(b.created_at);\n          \n          // Manejar fechas inv√°lidas - ponerlas al final\n          if (isNaN(dateA.getTime()) && isNaN(dateB.getTime())) return 0;\n          if (isNaN(dateA.getTime())) return 1;\n          if (isNaN(dateB.getTime())) return -1;\n          \n          return dateB - dateA;\n        });\n      case 'monto':\n        return sorted.sort((a, b) => {\n          const amountA = Number(a.amount) || 0;\n          const amountB = Number(b.amount) || 0;\n          return amountB - amountA;\n        });\n      case 'categoria':\n        return sorted.sort((a, b) => {\n          const categoryA = data.categories.find(c => c.id === a.category_id)?.name || 'Sin categor√≠a';\n          const categoryB = data.categories.find(c => c.id === b.category_id)?.name || 'Sin categor√≠a';\n          return categoryA.localeCompare(categoryB);\n        });\n      default:\n        return sorted;\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center h-64\">\n        <div className=\"spinner\"></div>\n        <span className=\"ml-2 text-fr-gray-600\">Cargando dashboard...</span>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n\n\n      {/* M√©tricas principales */}\n      <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 md:gap-6\">\n        {/* Balance total */}\n        <div className=\"card\">\n          <div className=\"flex items-start justify-between\">\n            <div className=\"flex-1 min-w-0\">\n              <p className=\"text-sm font-medium text-fr-gray-600\">\n                Balance Total\n              </p>\n              <p className={`text-xl lg:text-2xl font-bold ${data.balance >= 0 ? 'text-fr-secondary' : 'text-fr-error'} break-words`}>\n                {formatAmount(data.balance)}\n              </p>\n            </div>\n            <div className={`flex-shrink-0 p-2 lg:p-3 rounded-fr ${data.balance >= 0 ? 'bg-green-100' : 'bg-red-100'} ml-2`}>\n              <DollarSign className={`w-5 h-5 lg:w-6 lg:h-6 ${data.balance >= 0 ? 'text-fr-secondary' : 'text-fr-error'}`} />\n            </div>\n          </div>\n          <div className=\"mt-3 flex items-center\">\n            {data.balance >= 0 ? (\n              <ArrowUpRight className=\"w-4 h-4 text-fr-secondary mr-1 flex-shrink-0\" />\n            ) : (\n              <ArrowDownRight className=\"w-4 h-4 text-fr-error mr-1 flex-shrink-0\" />\n            )}\n            <span className={`text-sm ${data.balance >= 0 ? 'text-fr-secondary' : 'text-fr-error'}`}>\n              {data.balance >= 0 ? 'Positivo' : 'Negativo'}\n            </span>\n          </div>\n        </div>\n\n        {/* Total ingresos */}\n        <div className=\"card\">\n          <div className=\"flex items-start justify-between\">\n            <div className=\"flex-1 min-w-0\">\n              <p className=\"text-sm font-medium text-fr-gray-600\">\n                Total Ingresos\n              </p>\n              <p className=\"text-xl lg:text-2xl font-bold text-fr-secondary break-words\">\n                {formatAmount(data.totalIncome)}\n              </p>\n            </div>\n            <div className=\"flex-shrink-0 p-2 lg:p-3 rounded-fr bg-green-100 ml-2\">\n              <TrendingUp className=\"w-5 h-5 lg:w-6 lg:h-6 text-fr-secondary\" />\n            </div>\n          </div>\n          <div className=\"mt-3 flex items-center\">\n            <TrendingUp className=\"w-4 h-4 text-fr-secondary mr-1 flex-shrink-0\" />\n            <span className=\"text-sm text-fr-gray-500\">\n              {data.incomes.length} {data.incomes.length === 1 ? 'ingreso' : 'ingresos'} registrados\n            </span>\n          </div>\n        </div>\n\n        {/* Total gastos */}\n        <div className=\"card\">\n          <div className=\"flex items-start justify-between\">\n            <div className=\"flex-1 min-w-0\">\n              <p className=\"text-sm font-medium text-fr-gray-600\">\n                Total Gastos\n              </p>\n              <p className=\"text-xl lg:text-2xl font-bold text-fr-gray-900 break-words\">\n                {formatAmount(data.totalExpenses)}\n              </p>\n            </div>\n            <div className=\"flex-shrink-0 p-2 lg:p-3 rounded-fr bg-gray-100 ml-2\">\n              <TrendingDown className=\"w-5 h-5 lg:w-6 lg:h-6 text-fr-gray-900\" />\n            </div>\n          </div>\n          <div className=\"mt-3 flex items-center\">\n            <TrendingDown className=\"w-4 h-4 text-fr-gray-900 mr-1 flex-shrink-0\" />\n            <span className=\"text-sm text-fr-gray-500\">\n              {data.expenses.length} {data.expenses.length === 1 ? 'gasto' : 'gastos'} registrados\n            </span>\n          </div>\n        </div>\n\n        {/* Gastos pendientes */}\n        <div className=\"card\">\n          <div className=\"flex items-start justify-between\">\n            <div className=\"flex-1 min-w-0\">\n              <p className=\"text-sm font-medium text-fr-gray-600\">\n                Gastos Pendientes\n              </p>\n              <p className=\"text-xl lg:text-2xl font-bold text-fr-gray-900\">\n                {data.expenses.filter(e => !e.paid).length}\n              </p>\n            </div>\n            <div className=\"flex-shrink-0 p-2 lg:p-3 rounded-fr bg-gray-100 ml-2\">\n              <Calendar className=\"w-5 h-5 lg:w-6 lg:h-6 text-fr-gray-900\" />\n            </div>\n          </div>\n          <div className=\"mt-3\">\n            <span className=\"text-sm text-fr-gray-500\">\n              {formatAmount(data.expenses.filter(e => !e.paid).reduce((sum, e) => sum + e.amount, 0))} por pagar\n            </span>\n          </div>\n        </div>\n      </div>\n\n      {/* Transacciones por mes - Dos columnas */}\n      {hasActiveFilters && (data.expenses.length > 0 || data.incomes.length > 0) && (\n        <div className=\"card\">\n          <div className=\"flex items-center justify-between mb-6\">\n            <h3 className=\"text-lg font-semibold text-fr-gray-900\">\n              üí∞ Transacciones de {getPeriodTitle()}\n            </h3>\n            <div className=\"flex flex-col md:flex-row md:items-center md:space-x-4 space-y-4 md:space-y-0\">\n              {/* Dropdown de ordenamiento */}\n              <div className=\"flex items-center space-x-2\">\n                <label className=\"text-sm font-medium text-fr-gray-600\">Ordenar por:</label>\n                <select\n                  value={sortBy}\n                  onChange={(e) => setSortBy(e.target.value)}\n                  className=\"text-sm border border-fr-gray-300 rounded-fr px-3 py-1 focus:outline-none focus:ring-2 focus:ring-fr-primary focus:border-transparent\"\n                >\n                  <option value=\"fecha\">Fecha</option>\n                  <option value=\"monto\">Monto</option>\n                  <option value=\"categoria\">Categor√≠a</option>\n                </select>\n              </div>\n              \n              {/* Indicadores de cantidad */}\n              <div className=\"flex items-center space-x-4 text-sm\">\n                <div className=\"flex items-center\">\n                  <div className=\"w-3 h-3 bg-fr-error rounded-full mr-2\"></div>\n                  <span className=\"text-fr-gray-600\">Gastos ({data.expenses.length})</span>\n                </div>\n                <div className=\"flex items-center\">\n                  <div className=\"w-3 h-3 bg-fr-secondary rounded-full mr-2\"></div>\n                  <span className=\"text-fr-gray-600\">Ingresos ({data.incomes.length})</span>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          <div className=\"relative grid grid-cols-1 md:grid-cols-2 gap-4 lg:gap-6 xl:gap-8\">\n            {/* Columna de Gastos */}\n            <div className=\"space-y-4\">\n              <div className=\"space-y-3 mb-4\">\n                <div className=\"flex items-center justify-between\">\n                  <h4 className=\"font-semibold text-fr-gray-900 flex items-center\">\n                    <TrendingDown className=\"w-5 h-5 mr-2\" />\n                    Gastos\n                  </h4>\n                  <span className=\"text-lg font-bold text-fr-gray-900\">\n                    {formatAmount(data.totalExpenses)}\n                  </span>\n                </div>\n                \n\n              </div>\n              \n              <div className=\"space-y-3 max-h-96 overflow-y-auto\">\n                {data.expenses.length === 0 ? (\n                  <div className=\"text-center py-8 text-fr-gray-500\">\n                    <TrendingDown className=\"w-8 h-8 mx-auto mb-2 opacity-50\" />\n                    <p>No hay gastos en este per√≠odo</p>\n                  </div>\n                ) : (\n                  sortTransactions(data.expenses, sortBy)\n                    .map((expense, index) => {\n                      const category = data.categories.find(c => c.id === expense.category_id);\n                      const color = getCategoryColor(expense.category_id);\n                      return (\n                        <div key={expense.id || index} className={`flex items-center justify-between p-3 rounded-fr bg-white border border-fr-gray-100 hover:shadow-sm transition-shadow`}>\n                          <div className=\"flex items-start space-x-3\">\n                            {/* Indicador de pago */}\n                            <div className=\"flex-shrink-0 mt-1\">\n                              {expense.paid ? (\n                                <CheckCircle className=\"w-5 h-5 text-fr-secondary\" />\n                              ) : (\n                                <XCircle className=\"w-5 h-5 text-fr-error\" />\n                              )}\n                            </div>\n                            \n                            <div className=\"flex-1\">\n                              <div className=\"flex items-center space-x-2\">\n                                <p className=\"font-medium text-fr-gray-900 text-sm\">\n                                  {expense.description}\n                                </p>\n                                {!expense.paid && (\n                                  <span className=\"badge-error text-xs\">Pendiente</span>\n                                )}\n                                {category && (\n                                  <span className={`px-2 py-1 rounded text-xs font-medium ${color.bg} ${color.text} border ${color.border}`}>\n                                    {category.name}\n                                  </span>\n                                )}\n                              </div>\n                              <p className=\"text-xs text-fr-gray-500 mt-1\">\n                                {new Date(expense.created_at).toLocaleDateString('es-AR')}\n                                {expense.due_date && (\n                                  <span className=\"ml-2\">\n                                    ‚Ä¢ Vence: {new Date(expense.due_date).toLocaleDateString('es-AR')}\n                                  </span>\n                                )}\n                              </p>\n                            </div>\n                          </div>\n                          <div className=\"text-right ml-3\">\n                            <p className=\"font-semibold text-fr-gray-900\">\n                              -{formatAmount(expense.amount)}\n                            </p>\n                            {expense.percentage && (\n                              <p className=\"text-xs text-fr-gray-500\">\n                                {formatPercentage(expense.percentage)} del total\n                              </p>\n                            )}\n                            {expense.amount_paid > 0 && expense.amount_paid < expense.amount && (\n                              <p className=\"text-xs text-fr-gray-500\">\n                                Pagado: {formatAmount(expense.amount_paid)}\n                              </p>\n                            )}\n                          </div>\n                        </div>\n                      );\n                    })\n                )}\n              </div>\n            </div>\n\n            {/* Separador vertical - Solo visible en desktop */}\n            <div className=\"hidden lg:block absolute left-1/2 top-4 bottom-4 w-px bg-gradient-to-b from-transparent via-fr-gray-200 to-transparent transform -translate-x-1/2\"></div>\n\n            {/* Columna de Ingresos */}\n            <div className=\"space-y-4\">\n              <div className=\"space-y-3 mb-4\">\n                <div className=\"flex items-center justify-between\">\n                  <h4 className=\"font-semibold text-fr-secondary flex items-center\">\n                    <TrendingUp className=\"w-5 h-5 mr-2\" />\n                    Ingresos\n                  </h4>\n                  <span className=\"text-lg font-bold text-fr-secondary\">\n                    {formatAmount(data.totalIncome)}\n                  </span>\n                </div>\n\n              </div>\n              \n              <div className=\"space-y-3 max-h-96 overflow-y-auto\">\n                {data.incomes.length === 0 ? (\n                  <div className=\"text-center py-8 text-fr-gray-500\">\n                    <TrendingUp className=\"w-8 h-8 mx-auto mb-2 opacity-50\" />\n                    <p>No hay ingresos en este per√≠odo</p>\n                  </div>\n                ) : (\n                  sortTransactions(data.incomes, sortBy)\n                    .map((income, index) => {\n                      const color = getCategoryColor(income.category_id);\n                      const category = data.categories.find(c => c.id === income.category_id);\n                      return (\n                        <div key={income.id || index} className={`flex items-center justify-between p-3 rounded-fr bg-white border border-fr-gray-100 hover:shadow-sm transition-shadow`}>\n                          <div className=\"flex-1\">\n                            <div className=\"flex items-center space-x-2\">\n                              <p className=\"font-medium text-fr-gray-900 text-sm\">\n                                {income.description}\n                              </p>\n                              {category && (\n                                <span className={`px-2 py-1 rounded text-xs font-medium ${color.bg} ${color.text} border ${color.border}`}>\n                                  {category.name}\n                                </span>\n                              )}\n                            </div>\n                            <p className=\"text-xs text-fr-gray-500 mt-1\">\n                              {new Date(income.created_at).toLocaleDateString('es-AR')}\n                            </p>\n                          </div>\n                          <div className=\"text-right ml-3\">\n                            <p className=\"font-semibold text-fr-secondary\">\n                              +{formatAmount(income.amount)}\n                            </p>\n                            {income.percentage && (\n                              <p className=\"text-xs text-fr-gray-500\">\n                                {formatPercentage(income.percentage)}\n                              </p>\n                            )}\n                          </div>\n                        </div>\n                      );\n                    })\n                )}\n              </div>\n            </div>\n          </div>\n\n          {/* Resumen de totales del per√≠odo */}\n          {(data.expenses.length > 0 || data.incomes.length > 0) && (\n            <div className=\"mt-6 pt-4 border-t border-fr-gray-200\">\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4\">\n                {/* Total gastos */}\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"font-medium text-fr-gray-600\">Total gastos:</span>\n                  <div className=\"text-right\">\n                    <div className=\"font-bold text-fr-gray-900\">\n                      {formatAmount(data.totalExpenses)}\n                    </div>\n                    {data.totalIncome > 0 && (\n                      <div className=\"text-xs text-fr-gray-500\">\n                        {((data.totalExpenses / data.totalIncome) * 100).toFixed(1)}% de ingresos\n                      </div>\n                    )}\n                  </div>\n                </div>\n\n                {/* Total ingresos */}\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"font-medium text-fr-gray-600\">Total ingresos:</span>\n                  <div className=\"text-right\">\n                    <div className=\"font-bold text-fr-secondary\">\n                      {formatAmount(data.totalIncome)}\n                    </div>\n                    <div className=\"text-xs text-fr-gray-500\">\n                      100% base\n                    </div>\n                  </div>\n                </div>\n              </div>\n              \n              {/* Balance del per√≠odo */}\n              <div className=\"flex items-center justify-between pt-3 border-t border-fr-gray-200\">\n                <span className=\"text-fr-gray-600\">Balance del per√≠odo:</span>\n                <span className={`text-xl font-bold ${data.balance >= 0 ? 'text-fr-secondary' : 'text-fr-error'}`}>\n                  {data.balance >= 0 ? '+' : ''}{formatAmount(data.balance)}\n                </span>\n              </div>\n            </div>\n          )}\n        </div>\n      )}\n\n      {/* Gr√°ficos */}\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 lg:gap-6\">\n        {/* Gr√°fico de tendencias */}\n        <div className=\"card\">\n          <div className=\"flex items-center justify-between mb-6\">\n            <div>\n              <h3 className=\"text-lg font-semibold text-fr-gray-900\">\n                {hasActiveFilters ? `Datos de ${getPeriodTitle()}` : 'Tendencia Mensual'}\n              </h3>\n              <p className=\"text-sm text-fr-gray-500 mt-1\">\n                {hasActiveFilters \n                  ? 'Resumen del per√≠odo seleccionado' \n                  : 'Datos del mes actual (hist√≥rico pr√≥ximamente)'\n                }\n              </p>\n            </div>\n            <div className=\"flex flex-wrap items-center gap-4 text-sm\">\n              <div className=\"flex items-center\">\n                <div className=\"w-3 h-3 bg-fr-secondary rounded-full mr-2\"></div>\n                <span className=\"text-fr-gray-600\">Ingresos</span>\n              </div>\n              <div className=\"flex items-center\">\n                <div className=\"w-3 h-3 bg-fr-accent rounded-full mr-2\"></div>\n                <span className=\"text-fr-gray-600\">Gastos</span>\n              </div>\n            </div>\n          </div>\n          <ResponsiveContainer width=\"100%\" height={250}>\n            <AreaChart data={chartData}>\n              <CartesianGrid strokeDasharray=\"3 3\" stroke=\"#e5e7eb\" />\n              <XAxis dataKey=\"name\" stroke=\"#6b7280\" />\n              <YAxis stroke=\"#6b7280\" />\n              <Tooltip \n                formatter={(value) => [formatCurrency(value)]}\n                contentStyle={{\n                  backgroundColor: 'white',\n                  border: '1px solid #e5e7eb',\n                  borderRadius: '8px',\n                  boxShadow: '0 4px 12px 0 rgba(0, 0, 0, 0.15)',\n                }}\n              />\n              <Area\n                type=\"monotone\"\n                dataKey=\"ingresos\"\n                stackId=\"1\"\n                stroke=\"#00a650\"\n                fill=\"#00a650\"\n                fillOpacity={0.6}\n              />\n              <Area\n                type=\"monotone\"\n                dataKey=\"gastos\"\n                stackId=\"2\"\n                stroke=\"#ff6900\"\n                fill=\"#ff6900\"\n                fillOpacity={0.6}\n              />\n            </AreaChart>\n          </ResponsiveContainer>\n        </div>\n\n        {/* Gr√°fico de categor√≠as */}\n        <div className=\"card\">\n          <h3 className=\"text-lg font-semibold text-fr-gray-900 mb-6\">\n            Gastos por Categor√≠a{hasActiveFilters && ` - ${getPeriodTitle()}`}\n          </h3>\n          {pieData.length > 0 ? (\n            <div className=\"flex items-center justify-center\">\n              <ResponsiveContainer width=\"100%\" height={250}>\n                <RechartsPieChart>\n                  <Pie\n                    data={pieData}\n                    cx=\"50%\"\n                    cy=\"50%\"\n                    innerRadius={60}\n                    outerRadius={120}\n                    paddingAngle={5}\n                    dataKey=\"value\"\n                    label={({ name, value }) => `${name}: ${value}%`}\n                    labelLine={false}\n                  >\n                    {pieData.map((entry, index) => (\n                      <Cell key={`cell-${index}`} fill={entry.color} />\n                    ))}\n                  </Pie>\n                  <Tooltip \n                    formatter={(value, name, props) => [\n                      `${value}% (${formatCurrency(props.payload.amount)})`, \n                      'Porcentaje'\n                    ]}\n                    contentStyle={{\n                      backgroundColor: 'white',\n                      border: '1px solid #e5e7eb',\n                      borderRadius: '8px',\n                      boxShadow: '0 4px 12px 0 rgba(0, 0, 0, 0.15)',\n                    }}\n                  />\n                </RechartsPieChart>\n              </ResponsiveContainer>\n            </div>\n          ) : (\n            <div className=\"flex flex-col items-center justify-center h-64 text-center\">\n              <PieChart className=\"w-12 h-12 text-fr-gray-400 mb-4\" />\n              <h4 className=\"text-lg font-medium text-fr-gray-600 mb-2\">No hay gastos por categor√≠as</h4>\n              <p className=\"text-sm text-fr-gray-500\">\n                Los gastos aparecer√°n aqu√≠ una vez que agregues algunos gastos con categor√≠as\n              </p>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Transacciones recientes */}\n      <div className=\"card\">\n        <div className=\"flex items-center justify-between mb-6\">\n          <h3 className=\"text-lg font-semibold text-fr-gray-900\">Transacciones Recientes</h3>\n          <button className=\"btn-ghost\">Ver todas</button>\n        </div>\n        <div className=\"space-y-4\">\n          {(() => {\n            const allTransactions = [...data.expenses.slice(0, 3), ...data.incomes.slice(0, 2)];\n            const sortedTransactions = allTransactions\n              .sort((a, b) => new Date(b.created_at) - new Date(a.created_at))\n              .slice(0, 5);\n            \n            return sortedTransactions.map((transaction, index) => {\n              const isExpense = transaction.hasOwnProperty('paid');\n              const color = getCategoryColor(transaction.category_id);\n              const category = data.categories.find(c => c.id === transaction.category_id);\n              return (\n                <div key={index} className={`flex items-center justify-between p-4 rounded-fr bg-fr-gray-50 border-l-4 ${color.border || (isExpense ? 'border-fr-gray-900' : 'border-fr-secondary')}`}>\n                  <div className=\"flex items-center space-x-3\">\n                    <div className={`p-2 rounded-fr ${isExpense ? 'bg-gray-100' : 'bg-green-100'}`}>\n                      {isExpense ? (\n                        <TrendingDown className=\"w-4 h-4 text-fr-gray-900\" />\n                      ) : (\n                        <TrendingUp className=\"w-4 h-4 text-fr-secondary\" />\n                      )}\n                    </div>\n                    <div className=\"flex-1\">\n                      <div className=\"flex items-center space-x-2\">\n                        <p className=\"font-medium text-fr-gray-900\">{transaction.description}</p>\n                        {/* Indicador de pago solo para gastos */}\n                        {isExpense && (\n                          <div className=\"flex items-center space-x-1\">\n                            {transaction.paid ? (\n                              <CheckCircle className=\"w-4 h-4 text-fr-secondary\" />\n                            ) : (\n                              <XCircle className=\"w-4 h-4 text-fr-error\" />\n                            )}\n                            {!transaction.paid && (\n                              <span className=\"badge-error text-xs\">Pendiente</span>\n                            )}\n                          </div>\n                        )}\n                        {/* Badge de categor√≠a */}\n                        {category && (\n                          <span className={`px-2 py-1 rounded text-xs font-medium ${color.bg} ${color.text} border ${color.border}`}>\n                            {category.name}\n                          </span>\n                        )}\n                      </div>\n                      <p className=\"text-sm text-fr-gray-500\">\n                        {transaction.created_at ? formatDate(transaction.created_at) : 'Fecha no disponible'}\n                      </p>\n                    </div>\n                  </div>\n                  <div className=\"text-right\">\n                    <p className={`font-semibold ${isExpense ? 'text-fr-gray-900' : 'text-fr-secondary'}`}>\n                      {isExpense ? '-' : '+'}{formatAmount(transaction.amount)}\n                    </p>\n                    {transaction.percentage && (\n                      <p className=\"text-sm text-fr-gray-500\">\n                        {formatPercentage(transaction.percentage)} del total\n                      </p>\n                    )}\n                  </div>\n                </div>\n              );\n            });\n          })()}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Dashboard; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}