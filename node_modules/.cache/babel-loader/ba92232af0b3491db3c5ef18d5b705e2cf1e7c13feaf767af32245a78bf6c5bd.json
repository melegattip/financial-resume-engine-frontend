{"ast":null,"code":"import axios from 'axios';\nimport toast from '../utils/notifications';\nconst API_BASE_URL = process.env.REACT_APP_API_URL || 'http://localhost:8080/api/v1';\n\n// Crear instancia de axios para autenticaciÃ³n\nconst authAPI = axios.create({\n  baseURL: API_BASE_URL,\n  timeout: 10000,\n  headers: {\n    'Content-Type': 'application/json'\n  }\n});\n\n// Claves para localStorage\nconst TOKEN_KEY = 'auth_token';\nconst USER_KEY = 'auth_user';\nconst EXPIRES_AT_KEY = 'auth_expires_at';\n\n/**\n * Servicio de autenticaciÃ³n\n */\nclass AuthService {\n  constructor() {\n    this.token = localStorage.getItem(TOKEN_KEY);\n    this.user = null;\n    this.expiresAt = localStorage.getItem(EXPIRES_AT_KEY);\n\n    // Cargar usuario si existe token vÃ¡lido\n    this.loadUserFromStorage();\n\n    // Configurar interceptor de axios para agregar token automÃ¡ticamente\n    this.setupAuthInterceptor();\n  }\n\n  /**\n   * Carga el usuario del localStorage si hay un token vÃ¡lido\n   */\n  loadUserFromStorage() {\n    if (this.token && this.isTokenValid()) {\n      try {\n        const userData = localStorage.getItem(USER_KEY);\n        if (userData) {\n          this.user = JSON.parse(userData);\n        }\n      } catch (error) {\n        console.error('Error loading user from storage:', error);\n        this.clearAuthData();\n      }\n    } else {\n      this.clearAuthData();\n    }\n  }\n\n  /**\n   * Configura el interceptor de axios para agregar el token automÃ¡ticamente\n   */\n  setupAuthInterceptor() {\n    // Interceptor para requests\n    authAPI.interceptors.request.use(config => {\n      if (this.token && this.isTokenValid()) {\n        config.headers.Authorization = `Bearer ${this.token}`;\n      }\n      return config;\n    }, error => Promise.reject(error));\n\n    // Interceptor para responses\n    authAPI.interceptors.response.use(response => response, async error => {\n      var _originalRequest$url, _originalRequest$url2, _originalRequest$url3, _error$response;\n      const originalRequest = error.config;\n\n      // Solo intentar refresh si es un 401 y no es una peticiÃ³n de login/register\n      const isAuthEndpoint = ((_originalRequest$url = originalRequest.url) === null || _originalRequest$url === void 0 ? void 0 : _originalRequest$url.includes('/auth/login')) || ((_originalRequest$url2 = originalRequest.url) === null || _originalRequest$url2 === void 0 ? void 0 : _originalRequest$url2.includes('/auth/register')) || ((_originalRequest$url3 = originalRequest.url) === null || _originalRequest$url3 === void 0 ? void 0 : _originalRequest$url3.includes('/auth/refresh'));\n      if (((_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.status) === 401 && !originalRequest._retry && !isAuthEndpoint) {\n        originalRequest._retry = true;\n\n        // Solo intentar refresh token si tenemos un token vÃ¡lido almacenado\n        if (this.token && this.isTokenValid()) {\n          try {\n            await this.refreshToken();\n            originalRequest.headers.Authorization = `Bearer ${this.token}`;\n            return authAPI(originalRequest);\n          } catch (refreshError) {\n            this.logout();\n            window.location.href = '/login';\n            return Promise.reject(refreshError);\n          }\n        } else {\n          // Si no tenemos token vÃ¡lido, ir directo al login\n          this.logout();\n          window.location.href = '/login';\n          return Promise.reject(error);\n        }\n      }\n      return Promise.reject(error);\n    });\n  }\n\n  /**\n   * Verifica si el token actual es vÃ¡lido (no expirado)\n   */\n  isTokenValid() {\n    if (!this.token || !this.expiresAt) return false;\n    const now = Math.floor(Date.now() / 1000); // Tiempo actual en segundos\n    const expirationTime = parseInt(this.expiresAt);\n\n    // Considerar token invÃ¡lido si expira en los prÃ³ximos 5 minutos\n    return expirationTime > now + 300;\n  }\n\n  /**\n   * Registra un nuevo usuario\n   * @param {Object} userData - Datos del usuario (email, password, firstName, lastName)\n   */\n  async register(userData) {\n    try {\n      // Transformar datos del frontend al formato que espera el backend\n      const backendData = {\n        email: userData.email,\n        password: userData.password,\n        first_name: userData.firstName,\n        last_name: userData.lastName\n      };\n      console.log('ðŸ”§ Enviando datos de registro:', backendData);\n      const response = await authAPI.post('/auth/register', backendData);\n      const {\n        data\n      } = response.data;\n      this.saveAuthData(data);\n      toast.success('Â¡Registro exitoso! Bienvenido');\n      return {\n        success: true,\n        data\n      };\n    } catch (error) {\n      var _error$response2, _error$response3, _error$response3$data, _error$response4, _error$response4$data;\n      console.error('âŒ Error en registro:', ((_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : _error$response2.data) || error.message);\n      const message = ((_error$response3 = error.response) === null || _error$response3 === void 0 ? void 0 : (_error$response3$data = _error$response3.data) === null || _error$response3$data === void 0 ? void 0 : _error$response3$data.error) || ((_error$response4 = error.response) === null || _error$response4 === void 0 ? void 0 : (_error$response4$data = _error$response4.data) === null || _error$response4$data === void 0 ? void 0 : _error$response4$data.message) || 'Error en el registro';\n      toast.error(message);\n      throw new Error(message);\n    }\n  }\n\n  /**\n   * Inicia sesiÃ³n con email y contraseÃ±a\n   * @param {Object} credentials - Credenciales (email, password)\n   */\n  async login(credentials) {\n    try {\n      const response = await authAPI.post('/auth/login', credentials);\n      const {\n        data\n      } = response.data;\n      this.saveAuthData(data);\n      toast.success(`Â¡Bienvenido de vuelta, ${data.user.first_name}!`);\n      return {\n        success: true,\n        data\n      };\n    } catch (error) {\n      var _error$response5, _error$response5$data;\n      const message = ((_error$response5 = error.response) === null || _error$response5 === void 0 ? void 0 : (_error$response5$data = _error$response5.data) === null || _error$response5$data === void 0 ? void 0 : _error$response5$data.error) || 'Error en el login';\n      toast.error(message);\n      throw new Error(message);\n    }\n  }\n\n  /**\n   * Cierra la sesiÃ³n actual\n   */\n  async logout() {\n    try {\n      // Intentar notificar al servidor (opcional)\n      if (this.isAuthenticated()) {\n        await authAPI.post('/auth/logout');\n      }\n    } catch (error) {\n      // No importa si falla, igual limpiaremos el local storage\n      console.warn('Error during logout:', error);\n    } finally {\n      this.clearAuthData();\n      toast.success('SesiÃ³n cerrada correctamente');\n    }\n  }\n\n  /**\n   * Renueva el token JWT\n   */\n  async refreshToken() {\n    try {\n      const response = await authAPI.post('/auth/refresh');\n      const {\n        data\n      } = response.data;\n      this.saveAuthData(data);\n      return data;\n    } catch (error) {\n      this.clearAuthData();\n      throw new Error('Error renovando token');\n    }\n  }\n\n  /**\n   * Obtiene el perfil del usuario autenticado\n   */\n  async getProfile() {\n    try {\n      const response = await authAPI.get('/auth/profile');\n      const {\n        data\n      } = response.data;\n\n      // Actualizar datos del usuario en memoria y storage\n      this.user = data;\n      localStorage.setItem(USER_KEY, JSON.stringify(data));\n      return data;\n    } catch (error) {\n      var _error$response6, _error$response6$data;\n      const message = ((_error$response6 = error.response) === null || _error$response6 === void 0 ? void 0 : (_error$response6$data = _error$response6.data) === null || _error$response6$data === void 0 ? void 0 : _error$response6$data.error) || 'Error obteniendo perfil';\n      throw new Error(message);\n    }\n  }\n\n  /**\n   * Cambia la contraseÃ±a del usuario\n   * @param {Object} passwordData - Datos de cambio de contraseÃ±a\n   */\n  async changePassword(passwordData) {\n    try {\n      await authAPI.put('/auth/change-password', passwordData);\n      toast.success('ContraseÃ±a cambiada exitosamente');\n      return {\n        success: true\n      };\n    } catch (error) {\n      var _error$response7, _error$response7$data;\n      const message = ((_error$response7 = error.response) === null || _error$response7 === void 0 ? void 0 : (_error$response7$data = _error$response7.data) === null || _error$response7$data === void 0 ? void 0 : _error$response7$data.error) || 'Error cambiando contraseÃ±a';\n      toast.error(message);\n      throw new Error(message);\n    }\n  }\n\n  /**\n   * Guarda los datos de autenticaciÃ³n en localStorage\n   * @param {Object} authData - Datos de autenticaciÃ³n del servidor\n   */\n  saveAuthData(authData) {\n    const {\n      token,\n      expires_at,\n      user\n    } = authData;\n    this.token = token;\n    this.user = user;\n    this.expiresAt = expires_at;\n    localStorage.setItem(TOKEN_KEY, token);\n    localStorage.setItem(USER_KEY, JSON.stringify(user));\n    localStorage.setItem(EXPIRES_AT_KEY, expires_at.toString());\n  }\n\n  /**\n   * Limpia todos los datos de autenticaciÃ³n\n   */\n  clearAuthData() {\n    this.token = null;\n    this.user = null;\n    this.expiresAt = null;\n    localStorage.removeItem(TOKEN_KEY);\n    localStorage.removeItem(USER_KEY);\n    localStorage.removeItem(EXPIRES_AT_KEY);\n  }\n\n  /**\n   * Verifica si el usuario estÃ¡ autenticado\n   */\n  isAuthenticated() {\n    return this.token && this.user && this.isTokenValid();\n  }\n\n  /**\n   * Obtiene el usuario actual\n   */\n  getCurrentUser() {\n    return this.user;\n  }\n\n  /**\n   * Obtiene el token actual\n   */\n  getToken() {\n    return this.token;\n  }\n\n  /**\n   * Obtiene headers de autorizaciÃ³n para requests manuales\n   */\n  getAuthHeaders() {\n    if (this.token && this.isTokenValid()) {\n      return {\n        Authorization: `Bearer ${this.token}`\n      };\n    }\n    return {};\n  }\n\n  /**\n   * Verifica si el usuario tiene un rol especÃ­fico (para futuras implementaciones)\n   */\n  hasRole(role) {\n    var _this$user, _this$user$roles;\n    return ((_this$user = this.user) === null || _this$user === void 0 ? void 0 : (_this$user$roles = _this$user.roles) === null || _this$user$roles === void 0 ? void 0 : _this$user$roles.includes(role)) || false;\n  }\n\n  /**\n   * Obtiene informaciÃ³n de la sesiÃ³n\n   */\n  getSessionInfo() {\n    return {\n      isAuthenticated: this.isAuthenticated(),\n      user: this.user,\n      expiresAt: this.expiresAt ? new Date(parseInt(this.expiresAt) * 1000) : null,\n      timeUntilExpiry: this.expiresAt ? parseInt(this.expiresAt) - Math.floor(Date.now() / 1000) : 0\n    };\n  }\n}\n\n// Crear instancia Ãºnica\nconst authService = new AuthService();\n\n// Funciones de utilidad para facilitar el uso\nexport const authAPI_instance = authAPI; // Para requests manuales\nexport const isAuthenticated = () => authService.isAuthenticated();\nexport const getCurrentUser = () => authService.getCurrentUser();\nexport const getAuthHeaders = () => authService.getAuthHeaders();\nexport default authService;","map":{"version":3,"names":["axios","toast","API_BASE_URL","process","env","REACT_APP_API_URL","authAPI","create","baseURL","timeout","headers","TOKEN_KEY","USER_KEY","EXPIRES_AT_KEY","AuthService","constructor","token","localStorage","getItem","user","expiresAt","loadUserFromStorage","setupAuthInterceptor","isTokenValid","userData","JSON","parse","error","console","clearAuthData","interceptors","request","use","config","Authorization","Promise","reject","response","_originalRequest$url","_originalRequest$url2","_originalRequest$url3","_error$response","originalRequest","isAuthEndpoint","url","includes","status","_retry","refreshToken","refreshError","logout","window","location","href","now","Math","floor","Date","expirationTime","parseInt","register","backendData","email","password","first_name","firstName","last_name","lastName","log","post","data","saveAuthData","success","_error$response2","_error$response3","_error$response3$data","_error$response4","_error$response4$data","message","Error","login","credentials","_error$response5","_error$response5$data","isAuthenticated","warn","getProfile","get","setItem","stringify","_error$response6","_error$response6$data","changePassword","passwordData","put","_error$response7","_error$response7$data","authData","expires_at","toString","removeItem","getCurrentUser","getToken","getAuthHeaders","hasRole","role","_this$user","_this$user$roles","roles","getSessionInfo","timeUntilExpiry","authService","authAPI_instance"],"sources":["/Users/pmelegatti/Development/Financial Resume/financial-resume-engine-frontend/src/services/authService.js"],"sourcesContent":["import axios from 'axios';\nimport toast from '../utils/notifications';\n\nconst API_BASE_URL = process.env.REACT_APP_API_URL || 'http://localhost:8080/api/v1';\n\n// Crear instancia de axios para autenticaciÃ³n\nconst authAPI = axios.create({\n  baseURL: API_BASE_URL,\n  timeout: 10000,\n  headers: {\n    'Content-Type': 'application/json',\n  },\n});\n\n// Claves para localStorage\nconst TOKEN_KEY = 'auth_token';\nconst USER_KEY = 'auth_user';\nconst EXPIRES_AT_KEY = 'auth_expires_at';\n\n/**\n * Servicio de autenticaciÃ³n\n */\nclass AuthService {\n  constructor() {\n    this.token = localStorage.getItem(TOKEN_KEY);\n    this.user = null;\n    this.expiresAt = localStorage.getItem(EXPIRES_AT_KEY);\n    \n    // Cargar usuario si existe token vÃ¡lido\n    this.loadUserFromStorage();\n    \n    // Configurar interceptor de axios para agregar token automÃ¡ticamente\n    this.setupAuthInterceptor();\n  }\n\n  /**\n   * Carga el usuario del localStorage si hay un token vÃ¡lido\n   */\n  loadUserFromStorage() {\n    if (this.token && this.isTokenValid()) {\n      try {\n        const userData = localStorage.getItem(USER_KEY);\n        if (userData) {\n          this.user = JSON.parse(userData);\n        }\n      } catch (error) {\n        console.error('Error loading user from storage:', error);\n        this.clearAuthData();\n      }\n    } else {\n      this.clearAuthData();\n    }\n  }\n\n  /**\n   * Configura el interceptor de axios para agregar el token automÃ¡ticamente\n   */\n  setupAuthInterceptor() {\n    // Interceptor para requests\n    authAPI.interceptors.request.use(\n      (config) => {\n        if (this.token && this.isTokenValid()) {\n          config.headers.Authorization = `Bearer ${this.token}`;\n        }\n        return config;\n      },\n      (error) => Promise.reject(error)\n    );\n\n    // Interceptor para responses\n    authAPI.interceptors.response.use(\n      (response) => response,\n      async (error) => {\n        const originalRequest = error.config;\n\n        // Solo intentar refresh si es un 401 y no es una peticiÃ³n de login/register\n        const isAuthEndpoint = originalRequest.url?.includes('/auth/login') || \n                              originalRequest.url?.includes('/auth/register') ||\n                              originalRequest.url?.includes('/auth/refresh');\n\n        if (error.response?.status === 401 && !originalRequest._retry && !isAuthEndpoint) {\n          originalRequest._retry = true;\n\n          // Solo intentar refresh token si tenemos un token vÃ¡lido almacenado\n          if (this.token && this.isTokenValid()) {\n            try {\n              await this.refreshToken();\n              originalRequest.headers.Authorization = `Bearer ${this.token}`;\n              return authAPI(originalRequest);\n            } catch (refreshError) {\n              this.logout();\n              window.location.href = '/login';\n              return Promise.reject(refreshError);\n            }\n          } else {\n            // Si no tenemos token vÃ¡lido, ir directo al login\n            this.logout();\n            window.location.href = '/login';\n            return Promise.reject(error);\n          }\n        }\n\n        return Promise.reject(error);\n      }\n    );\n  }\n\n  /**\n   * Verifica si el token actual es vÃ¡lido (no expirado)\n   */\n  isTokenValid() {\n    if (!this.token || !this.expiresAt) return false;\n    \n    const now = Math.floor(Date.now() / 1000); // Tiempo actual en segundos\n    const expirationTime = parseInt(this.expiresAt);\n    \n    // Considerar token invÃ¡lido si expira en los prÃ³ximos 5 minutos\n    return expirationTime > (now + 300);\n  }\n\n  /**\n   * Registra un nuevo usuario\n   * @param {Object} userData - Datos del usuario (email, password, firstName, lastName)\n   */\n  async register(userData) {\n    try {\n      // Transformar datos del frontend al formato que espera el backend\n      const backendData = {\n        email: userData.email,\n        password: userData.password,\n        first_name: userData.firstName,\n        last_name: userData.lastName\n      };\n      \n      console.log('ðŸ”§ Enviando datos de registro:', backendData);\n      \n      const response = await authAPI.post('/auth/register', backendData);\n      const { data } = response.data;\n      \n      this.saveAuthData(data);\n      \n      toast.success('Â¡Registro exitoso! Bienvenido');\n      return { success: true, data };\n    } catch (error) {\n      console.error('âŒ Error en registro:', error.response?.data || error.message);\n      const message = error.response?.data?.error || error.response?.data?.message || 'Error en el registro';\n      toast.error(message);\n      throw new Error(message);\n    }\n  }\n\n  /**\n   * Inicia sesiÃ³n con email y contraseÃ±a\n   * @param {Object} credentials - Credenciales (email, password)\n   */\n  async login(credentials) {\n    try {\n      const response = await authAPI.post('/auth/login', credentials);\n      const { data } = response.data;\n      \n      this.saveAuthData(data);\n      \n      toast.success(`Â¡Bienvenido de vuelta, ${data.user.first_name}!`);\n      return { success: true, data };\n    } catch (error) {\n      const message = error.response?.data?.error || 'Error en el login';\n      toast.error(message);\n      throw new Error(message);\n    }\n  }\n\n  /**\n   * Cierra la sesiÃ³n actual\n   */\n  async logout() {\n    try {\n      // Intentar notificar al servidor (opcional)\n      if (this.isAuthenticated()) {\n        await authAPI.post('/auth/logout');\n      }\n    } catch (error) {\n      // No importa si falla, igual limpiaremos el local storage\n      console.warn('Error during logout:', error);\n    } finally {\n      this.clearAuthData();\n      toast.success('SesiÃ³n cerrada correctamente');\n    }\n  }\n\n  /**\n   * Renueva el token JWT\n   */\n  async refreshToken() {\n    try {\n      const response = await authAPI.post('/auth/refresh');\n      const { data } = response.data;\n      \n      this.saveAuthData(data);\n      return data;\n    } catch (error) {\n      this.clearAuthData();\n      throw new Error('Error renovando token');\n    }\n  }\n\n  /**\n   * Obtiene el perfil del usuario autenticado\n   */\n  async getProfile() {\n    try {\n      const response = await authAPI.get('/auth/profile');\n      const { data } = response.data;\n      \n      // Actualizar datos del usuario en memoria y storage\n      this.user = data;\n      localStorage.setItem(USER_KEY, JSON.stringify(data));\n      \n      return data;\n    } catch (error) {\n      const message = error.response?.data?.error || 'Error obteniendo perfil';\n      throw new Error(message);\n    }\n  }\n\n  /**\n   * Cambia la contraseÃ±a del usuario\n   * @param {Object} passwordData - Datos de cambio de contraseÃ±a\n   */\n  async changePassword(passwordData) {\n    try {\n      await authAPI.put('/auth/change-password', passwordData);\n      toast.success('ContraseÃ±a cambiada exitosamente');\n      return { success: true };\n    } catch (error) {\n      const message = error.response?.data?.error || 'Error cambiando contraseÃ±a';\n      toast.error(message);\n      throw new Error(message);\n    }\n  }\n\n  /**\n   * Guarda los datos de autenticaciÃ³n en localStorage\n   * @param {Object} authData - Datos de autenticaciÃ³n del servidor\n   */\n  saveAuthData(authData) {\n    const { token, expires_at, user } = authData;\n    \n    this.token = token;\n    this.user = user;\n    this.expiresAt = expires_at;\n    \n    localStorage.setItem(TOKEN_KEY, token);\n    localStorage.setItem(USER_KEY, JSON.stringify(user));\n    localStorage.setItem(EXPIRES_AT_KEY, expires_at.toString());\n  }\n\n  /**\n   * Limpia todos los datos de autenticaciÃ³n\n   */\n  clearAuthData() {\n    this.token = null;\n    this.user = null;\n    this.expiresAt = null;\n    \n    localStorage.removeItem(TOKEN_KEY);\n    localStorage.removeItem(USER_KEY);\n    localStorage.removeItem(EXPIRES_AT_KEY);\n  }\n\n  /**\n   * Verifica si el usuario estÃ¡ autenticado\n   */\n  isAuthenticated() {\n    return this.token && this.user && this.isTokenValid();\n  }\n\n  /**\n   * Obtiene el usuario actual\n   */\n  getCurrentUser() {\n    return this.user;\n  }\n\n  /**\n   * Obtiene el token actual\n   */\n  getToken() {\n    return this.token;\n  }\n\n  /**\n   * Obtiene headers de autorizaciÃ³n para requests manuales\n   */\n  getAuthHeaders() {\n    if (this.token && this.isTokenValid()) {\n      return {\n        Authorization: `Bearer ${this.token}`,\n      };\n    }\n    return {};\n  }\n\n  /**\n   * Verifica si el usuario tiene un rol especÃ­fico (para futuras implementaciones)\n   */\n  hasRole(role) {\n    return this.user?.roles?.includes(role) || false;\n  }\n\n  /**\n   * Obtiene informaciÃ³n de la sesiÃ³n\n   */\n  getSessionInfo() {\n    return {\n      isAuthenticated: this.isAuthenticated(),\n      user: this.user,\n      expiresAt: this.expiresAt ? new Date(parseInt(this.expiresAt) * 1000) : null,\n      timeUntilExpiry: this.expiresAt ? (parseInt(this.expiresAt) - Math.floor(Date.now() / 1000)) : 0,\n    };\n  }\n}\n\n// Crear instancia Ãºnica\nconst authService = new AuthService();\n\n// Funciones de utilidad para facilitar el uso\nexport const authAPI_instance = authAPI; // Para requests manuales\nexport const isAuthenticated = () => authService.isAuthenticated();\nexport const getCurrentUser = () => authService.getCurrentUser();\nexport const getAuthHeaders = () => authService.getAuthHeaders();\n\nexport default authService; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}