{"ast":null,"code":"import React,{createContext,useContext,useState,useCallback}from'react';// Crear el contexto\nimport{jsx as _jsx}from\"react/jsx-runtime\";const PeriodContext=/*#__PURE__*/createContext();// Hook personalizado para usar el contexto\nexport const usePeriod=()=>{const context=useContext(PeriodContext);if(!context){throw new Error('usePeriod debe ser usado dentro de un PeriodProvider');}return context;};// Provider del contexto\nexport const PeriodProvider=_ref=>{let{children}=_ref;const[selectedYear,setSelectedYear]=useState('');const[selectedMonth,setSelectedMonth]=useState('');const[availableYears,setAvailableYears]=useState([]);const[availableMonths,setAvailableMonths]=useState([]);const[balancesHidden,setBalancesHidden]=useState(false);// Función para actualizar los datos disponibles (solo se ejecuta una vez al cargar)\nconst updateAvailableData=useCallback(function(){let expenses=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];let incomes=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];const years=new Set();const months=new Set();// Procesar todas las transacciones sin filtrar\n[...expenses,...incomes].forEach(item=>{if(item.created_at){const date=new Date(item.created_at);// Validar que la fecha sea válida\nif(!isNaN(date.getTime())){const year=date.getFullYear().toString();const month=date.toISOString().slice(0,7);years.add(year);months.add(month);}}});// Siempre incluir el año y mes actual\nconst currentDate=new Date();const currentYear=currentDate.getFullYear().toString();const currentMonth=currentDate.toISOString().slice(0,7);years.add(currentYear);months.add(currentMonth);// Convertir a arrays ordenados\nconst sortedYears=Array.from(years).sort().reverse();const sortedMonths=Array.from(months).sort().reverse();// SOLO actualizar si realmente hay cambios para evitar loops infinitos\nsetAvailableYears(prevYears=>{const yearsChanged=JSON.stringify(prevYears)!==JSON.stringify(sortedYears);return yearsChanged?sortedYears:prevYears;});setAvailableMonths(prevMonths=>{const monthsChanged=JSON.stringify(prevMonths)!==JSON.stringify(sortedMonths);return monthsChanged?sortedMonths:prevMonths;});// Comentado: Auto-seleccionar el último mes (para mostrar todos los datos por defecto)\n// if (!selectedMonth && sortedMonths.length > 0) {\n//   const latestMonth = sortedMonths[0];\n//   const [latestYear] = latestMonth.split('-');\n//   \n//   setSelectedMonth(latestMonth);\n//   setSelectedYear(latestYear);\n// }\n},[]);// Remover selectedMonth de las dependencias\n// Función para obtener meses disponibles para el año seleccionado\nconst getMonthsForSelectedYear=useCallback(()=>{if(!selectedYear)return availableMonths;return availableMonths.filter(month=>{const[year]=month.split('-');return year===selectedYear;});},[selectedYear,availableMonths]);// Función para limpiar filtros\nconst clearFilters=useCallback(()=>{setSelectedYear('');setSelectedMonth('');},[]);// Función para obtener parámetros de filtro para las APIs\nconst getFilterParams=useCallback(()=>{const params={};if(selectedYear)params.year=selectedYear;if(selectedMonth){const[year,month]=selectedMonth.split('-');params.year=year;params.month=month;}return params;},[selectedYear,selectedMonth]);// Función para obtener el título del período seleccionado\nconst getPeriodTitle=useCallback(()=>{if(selectedMonth){const[year,month]=selectedMonth.split('-');const date=new Date(parseInt(year),parseInt(month)-1,1);const formatted=date.toLocaleDateString('es-AR',{year:'numeric',month:'long'});return formatted.charAt(0).toUpperCase()+formatted.slice(1);}else if(selectedYear){return\"A\\xF1o \".concat(selectedYear);}return'Todos los períodos';},[selectedMonth,selectedYear]);// Verificar si hay filtros activos\nconst hasActiveFilters=selectedMonth||selectedYear;// Función para alternar visibilidad de saldos\nconst toggleBalancesVisibility=useCallback(()=>{setBalancesHidden(!balancesHidden);},[balancesHidden]);const value={// Estado\nselectedYear,selectedMonth,availableYears,availableMonths,hasActiveFilters,balancesHidden,// Acciones\nsetSelectedYear,setSelectedMonth,updateAvailableData,clearFilters,toggleBalancesVisibility,// Utilidades\ngetFilterParams,getPeriodTitle,getMonthsForSelectedYear};return/*#__PURE__*/_jsx(PeriodContext.Provider,{value:value,children:children});};","map":{"version":3,"names":["React","createContext","useContext","useState","useCallback","jsx","_jsx","PeriodContext","usePeriod","context","Error","PeriodProvider","_ref","children","selectedYear","setSelectedYear","selectedMonth","setSelectedMonth","availableYears","setAvailableYears","availableMonths","setAvailableMonths","balancesHidden","setBalancesHidden","updateAvailableData","expenses","arguments","length","undefined","incomes","years","Set","months","forEach","item","created_at","date","Date","isNaN","getTime","year","getFullYear","toString","month","toISOString","slice","add","currentDate","currentYear","currentMonth","sortedYears","Array","from","sort","reverse","sortedMonths","prevYears","yearsChanged","JSON","stringify","prevMonths","monthsChanged","getMonthsForSelectedYear","filter","split","clearFilters","getFilterParams","params","getPeriodTitle","parseInt","formatted","toLocaleDateString","charAt","toUpperCase","concat","hasActiveFilters","toggleBalancesVisibility","value","Provider"],"sources":["/Users/pmelegatti/Development/Financial Resume/financial-resume-engine-frontend/src/contexts/PeriodContext.js"],"sourcesContent":["import React, { createContext, useContext, useState, useCallback } from 'react';\n\n// Crear el contexto\nconst PeriodContext = createContext();\n\n// Hook personalizado para usar el contexto\nexport const usePeriod = () => {\n  const context = useContext(PeriodContext);\n  if (!context) {\n    throw new Error('usePeriod debe ser usado dentro de un PeriodProvider');\n  }\n  return context;\n};\n\n// Provider del contexto\nexport const PeriodProvider = ({ children }) => {\n  const [selectedYear, setSelectedYear] = useState('');\n  const [selectedMonth, setSelectedMonth] = useState('');\n  const [availableYears, setAvailableYears] = useState([]);\n  const [availableMonths, setAvailableMonths] = useState([]);\n  const [balancesHidden, setBalancesHidden] = useState(false);\n\n  // Función para actualizar los datos disponibles (solo se ejecuta una vez al cargar)\n  const updateAvailableData = useCallback((expenses = [], incomes = []) => {\n    const years = new Set();\n    const months = new Set();\n    \n    // Procesar todas las transacciones sin filtrar\n    [...expenses, ...incomes].forEach(item => {\n      if (item.created_at) {\n        const date = new Date(item.created_at);\n        \n        // Validar que la fecha sea válida\n        if (!isNaN(date.getTime())) {\n          const year = date.getFullYear().toString();\n          const month = date.toISOString().slice(0, 7);\n          \n          years.add(year);\n          months.add(month);\n        }\n      }\n    });\n    \n    // Siempre incluir el año y mes actual\n    const currentDate = new Date();\n    const currentYear = currentDate.getFullYear().toString();\n    const currentMonth = currentDate.toISOString().slice(0, 7);\n    \n    years.add(currentYear);\n    months.add(currentMonth);\n    \n    // Convertir a arrays ordenados\n    const sortedYears = Array.from(years).sort().reverse();\n    const sortedMonths = Array.from(months).sort().reverse();\n    \n    // SOLO actualizar si realmente hay cambios para evitar loops infinitos\n    setAvailableYears(prevYears => {\n      const yearsChanged = JSON.stringify(prevYears) !== JSON.stringify(sortedYears);\n      return yearsChanged ? sortedYears : prevYears;\n    });\n    \n    setAvailableMonths(prevMonths => {\n      const monthsChanged = JSON.stringify(prevMonths) !== JSON.stringify(sortedMonths);\n      return monthsChanged ? sortedMonths : prevMonths;\n    });\n    \n    // Comentado: Auto-seleccionar el último mes (para mostrar todos los datos por defecto)\n    // if (!selectedMonth && sortedMonths.length > 0) {\n    //   const latestMonth = sortedMonths[0];\n    //   const [latestYear] = latestMonth.split('-');\n    //   \n    //   setSelectedMonth(latestMonth);\n    //   setSelectedYear(latestYear);\n    // }\n  }, []); // Remover selectedMonth de las dependencias\n\n  // Función para obtener meses disponibles para el año seleccionado\n  const getMonthsForSelectedYear = useCallback(() => {\n    if (!selectedYear) return availableMonths;\n    \n    return availableMonths.filter(month => {\n      const [year] = month.split('-');\n      return year === selectedYear;\n    });\n  }, [selectedYear, availableMonths]);\n\n  // Función para limpiar filtros\n  const clearFilters = useCallback(() => {\n    setSelectedYear('');\n    setSelectedMonth('');\n  }, []);\n\n  // Función para obtener parámetros de filtro para las APIs\n  const getFilterParams = useCallback(() => {\n    const params = {};\n    \n    if (selectedYear) params.year = selectedYear;\n    if (selectedMonth) {\n      const [year, month] = selectedMonth.split('-');\n      params.year = year;\n      params.month = month;\n    }\n    \n    return params;\n  }, [selectedYear, selectedMonth]);\n\n  // Función para obtener el título del período seleccionado\n  const getPeriodTitle = useCallback(() => {\n    if (selectedMonth) {\n      const [year, month] = selectedMonth.split('-');\n      const date = new Date(parseInt(year), parseInt(month) - 1, 1);\n      const formatted = date.toLocaleDateString('es-AR', { \n        year: 'numeric', \n        month: 'long' \n      });\n      return formatted.charAt(0).toUpperCase() + formatted.slice(1);\n    } else if (selectedYear) {\n      return `Año ${selectedYear}`;\n    }\n    return 'Todos los períodos';\n  }, [selectedMonth, selectedYear]);\n\n  // Verificar si hay filtros activos\n  const hasActiveFilters = selectedMonth || selectedYear;\n\n  // Función para alternar visibilidad de saldos\n  const toggleBalancesVisibility = useCallback(() => {\n    setBalancesHidden(!balancesHidden);\n  }, [balancesHidden]);\n\n  const value = {\n    // Estado\n    selectedYear,\n    selectedMonth,\n    availableYears,\n    availableMonths,\n    hasActiveFilters,\n    balancesHidden,\n    \n    // Acciones\n    setSelectedYear,\n    setSelectedMonth,\n    updateAvailableData,\n    clearFilters,\n    toggleBalancesVisibility,\n    \n    // Utilidades\n    getFilterParams,\n    getPeriodTitle,\n    getMonthsForSelectedYear,\n  };\n\n  return (\n    <PeriodContext.Provider value={value}>\n      {children}\n    </PeriodContext.Provider>\n  );\n}; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}